import { RawSourceMap } from 'source-map';

export import CachedSource = require('webpack-sources/lib/CachedSource');
export import CompatSource = require('webpack-sources/lib/CompatSource');
export import ConcatSource = require('webpack-sources/lib/ConcatSource');
export import OriginalSource = require('webpack-sources/lib/OriginalSource');
export import PrefixSource = require('webpack-sources/lib/PrefixSource');
export import RawSource = require('webpack-sources/lib/RawSource');
export import ReplaceSource = require('webpack-sources/lib/ReplaceSource');
export import SizeOnlySource = require('webpack-sources/lib/SizeOnlySource');
export import Source = require('webpack-sources/lib/Source');
export import SourceMapSource = require('webpack-sources/lib/SourceMapSource');

export interface MapOptions {
    /**
     * If set to false the implementation may omit mappings for columns
     * @default true
     */
    columns?: boolean | undefined;
    /**
     * If set to false the implementation may omit inner mappings for modules.
     * @default true
     */
    module?: boolean | undefined;
}

export interface SourceAndMapMixin {
    /**
     * Returns the SourceMap of the represented source code as JSON.
     * May return `null` if no SourceMap is available.
     */
    map(options?: MapOptions): RawSourceMap | null;
    /**
     * Returns both, source code (like `Source.prototype.source()` and SourceMap (like `Source.prototype.map()`).
     * This method could have better performance than calling `source()` and `map()` separately.
     */
    sourceAndMap(options?: MapOptions): SourceAndMapResult;
}

export interface SourceAndMapResult {
    source: string | Buffer;
    map: RawSourceMap | null;
}

export interface Replacement {
    readonly start: number;
    readonly end: number;
    readonly content: string;
    readonly insertIndex: number;
    readonly name: string;
}

export type SourceLike = Partial<Pick<Source, 'source' | 'buffer' | 'size' | 'map' | 'sourceAndMap' | 'updateHash'>>;

export interface CachedData {
    buffer?: Buffer | undefined;
    source?: string | boolean | undefined;
    size?: number | undefined;
    cachedData?: Map<any, any> | undefined;
}
