{"ast":null,"code":"'use strict';\n\nconst {\n  DOCUMENT_MODE\n} = require('./html'); //Const\n\n\nconst VALID_DOCTYPE_NAME = 'html';\nconst VALID_SYSTEM_ID = 'about:legacy-compat';\nconst QUIRKS_MODE_SYSTEM_ID = 'http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd';\nconst QUIRKS_MODE_PUBLIC_ID_PREFIXES = ['+//silmaril//dtd html pro v0r11 19970101//', '-//as//dtd html 3.0 aswedit + extensions//', '-//advasoft ltd//dtd html 3.0 aswedit + extensions//', '-//ietf//dtd html 2.0 level 1//', '-//ietf//dtd html 2.0 level 2//', '-//ietf//dtd html 2.0 strict level 1//', '-//ietf//dtd html 2.0 strict level 2//', '-//ietf//dtd html 2.0 strict//', '-//ietf//dtd html 2.0//', '-//ietf//dtd html 2.1e//', '-//ietf//dtd html 3.0//', '-//ietf//dtd html 3.2 final//', '-//ietf//dtd html 3.2//', '-//ietf//dtd html 3//', '-//ietf//dtd html level 0//', '-//ietf//dtd html level 1//', '-//ietf//dtd html level 2//', '-//ietf//dtd html level 3//', '-//ietf//dtd html strict level 0//', '-//ietf//dtd html strict level 1//', '-//ietf//dtd html strict level 2//', '-//ietf//dtd html strict level 3//', '-//ietf//dtd html strict//', '-//ietf//dtd html//', '-//metrius//dtd metrius presentational//', '-//microsoft//dtd internet explorer 2.0 html strict//', '-//microsoft//dtd internet explorer 2.0 html//', '-//microsoft//dtd internet explorer 2.0 tables//', '-//microsoft//dtd internet explorer 3.0 html strict//', '-//microsoft//dtd internet explorer 3.0 html//', '-//microsoft//dtd internet explorer 3.0 tables//', '-//netscape comm. corp.//dtd html//', '-//netscape comm. corp.//dtd strict html//', \"-//o'reilly and associates//dtd html 2.0//\", \"-//o'reilly and associates//dtd html extended 1.0//\", \"-//o'reilly and associates//dtd html extended relaxed 1.0//\", '-//sq//dtd html 2.0 hotmetal + extensions//', '-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//', '-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//', '-//spyglass//dtd html 2.0 extended//', '-//sun microsystems corp.//dtd hotjava html//', '-//sun microsystems corp.//dtd hotjava strict html//', '-//w3c//dtd html 3 1995-03-24//', '-//w3c//dtd html 3.2 draft//', '-//w3c//dtd html 3.2 final//', '-//w3c//dtd html 3.2//', '-//w3c//dtd html 3.2s draft//', '-//w3c//dtd html 4.0 frameset//', '-//w3c//dtd html 4.0 transitional//', '-//w3c//dtd html experimental 19960712//', '-//w3c//dtd html experimental 970421//', '-//w3c//dtd w3 html//', '-//w3o//dtd w3 html 3.0//', '-//webtechs//dtd mozilla html 2.0//', '-//webtechs//dtd mozilla html//'];\nconst QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES = QUIRKS_MODE_PUBLIC_ID_PREFIXES.concat(['-//w3c//dtd html 4.01 frameset//', '-//w3c//dtd html 4.01 transitional//']);\nconst QUIRKS_MODE_PUBLIC_IDS = ['-//w3o//dtd w3 html strict 3.0//en//', '-/w3c/dtd html 4.0 transitional/en', 'html'];\nconst LIMITED_QUIRKS_PUBLIC_ID_PREFIXES = ['-//w3c//dtd xhtml 1.0 frameset//', '-//w3c//dtd xhtml 1.0 transitional//'];\nconst LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES = LIMITED_QUIRKS_PUBLIC_ID_PREFIXES.concat(['-//w3c//dtd html 4.01 frameset//', '-//w3c//dtd html 4.01 transitional//']); //Utils\n\nfunction enquoteDoctypeId(id) {\n  const quote = id.indexOf('\"') !== -1 ? \"'\" : '\"';\n  return quote + id + quote;\n}\n\nfunction hasPrefix(publicId, prefixes) {\n  for (let i = 0; i < prefixes.length; i++) {\n    if (publicId.indexOf(prefixes[i]) === 0) {\n      return true;\n    }\n  }\n\n  return false;\n} //API\n\n\nexports.isConforming = function (token) {\n  return token.name === VALID_DOCTYPE_NAME && token.publicId === null && (token.systemId === null || token.systemId === VALID_SYSTEM_ID);\n};\n\nexports.getDocumentMode = function (token) {\n  if (token.name !== VALID_DOCTYPE_NAME) {\n    return DOCUMENT_MODE.QUIRKS;\n  }\n\n  const systemId = token.systemId;\n\n  if (systemId && systemId.toLowerCase() === QUIRKS_MODE_SYSTEM_ID) {\n    return DOCUMENT_MODE.QUIRKS;\n  }\n\n  let publicId = token.publicId;\n\n  if (publicId !== null) {\n    publicId = publicId.toLowerCase();\n\n    if (QUIRKS_MODE_PUBLIC_IDS.indexOf(publicId) > -1) {\n      return DOCUMENT_MODE.QUIRKS;\n    }\n\n    let prefixes = systemId === null ? QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES : QUIRKS_MODE_PUBLIC_ID_PREFIXES;\n\n    if (hasPrefix(publicId, prefixes)) {\n      return DOCUMENT_MODE.QUIRKS;\n    }\n\n    prefixes = systemId === null ? LIMITED_QUIRKS_PUBLIC_ID_PREFIXES : LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES;\n\n    if (hasPrefix(publicId, prefixes)) {\n      return DOCUMENT_MODE.LIMITED_QUIRKS;\n    }\n  }\n\n  return DOCUMENT_MODE.NO_QUIRKS;\n};\n\nexports.serializeContent = function (name, publicId, systemId) {\n  let str = '!DOCTYPE ';\n\n  if (name) {\n    str += name;\n  }\n\n  if (publicId) {\n    str += ' PUBLIC ' + enquoteDoctypeId(publicId);\n  } else if (systemId) {\n    str += ' SYSTEM';\n  }\n\n  if (systemId !== null) {\n    str += ' ' + enquoteDoctypeId(systemId);\n  }\n\n  return str;\n};","map":{"version":3,"sources":["/Users/leon/lib-test/liraz-test/node_modules/parse5/lib/common/doctype.js"],"names":["DOCUMENT_MODE","require","VALID_DOCTYPE_NAME","VALID_SYSTEM_ID","QUIRKS_MODE_SYSTEM_ID","QUIRKS_MODE_PUBLIC_ID_PREFIXES","QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES","concat","QUIRKS_MODE_PUBLIC_IDS","LIMITED_QUIRKS_PUBLIC_ID_PREFIXES","LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES","enquoteDoctypeId","id","quote","indexOf","hasPrefix","publicId","prefixes","i","length","exports","isConforming","token","name","systemId","getDocumentMode","QUIRKS","toLowerCase","LIMITED_QUIRKS","NO_QUIRKS","serializeContent","str"],"mappings":"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","sourcesContent":["'use strict';\n\nconst { DOCUMENT_MODE } = require('./html');\n\n//Const\nconst VALID_DOCTYPE_NAME = 'html';\nconst VALID_SYSTEM_ID = 'about:legacy-compat';\nconst QUIRKS_MODE_SYSTEM_ID = 'http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd';\n\nconst QUIRKS_MODE_PUBLIC_ID_PREFIXES = [\n    '+//silmaril//dtd html pro v0r11 19970101//',\n    '-//as//dtd html 3.0 aswedit + extensions//',\n    '-//advasoft ltd//dtd html 3.0 aswedit + extensions//',\n    '-//ietf//dtd html 2.0 level 1//',\n    '-//ietf//dtd html 2.0 level 2//',\n    '-//ietf//dtd html 2.0 strict level 1//',\n    '-//ietf//dtd html 2.0 strict level 2//',\n    '-//ietf//dtd html 2.0 strict//',\n    '-//ietf//dtd html 2.0//',\n    '-//ietf//dtd html 2.1e//',\n    '-//ietf//dtd html 3.0//',\n    '-//ietf//dtd html 3.2 final//',\n    '-//ietf//dtd html 3.2//',\n    '-//ietf//dtd html 3//',\n    '-//ietf//dtd html level 0//',\n    '-//ietf//dtd html level 1//',\n    '-//ietf//dtd html level 2//',\n    '-//ietf//dtd html level 3//',\n    '-//ietf//dtd html strict level 0//',\n    '-//ietf//dtd html strict level 1//',\n    '-//ietf//dtd html strict level 2//',\n    '-//ietf//dtd html strict level 3//',\n    '-//ietf//dtd html strict//',\n    '-//ietf//dtd html//',\n    '-//metrius//dtd metrius presentational//',\n    '-//microsoft//dtd internet explorer 2.0 html strict//',\n    '-//microsoft//dtd internet explorer 2.0 html//',\n    '-//microsoft//dtd internet explorer 2.0 tables//',\n    '-//microsoft//dtd internet explorer 3.0 html strict//',\n    '-//microsoft//dtd internet explorer 3.0 html//',\n    '-//microsoft//dtd internet explorer 3.0 tables//',\n    '-//netscape comm. corp.//dtd html//',\n    '-//netscape comm. corp.//dtd strict html//',\n    \"-//o'reilly and associates//dtd html 2.0//\",\n    \"-//o'reilly and associates//dtd html extended 1.0//\",\n    \"-//o'reilly and associates//dtd html extended relaxed 1.0//\",\n    '-//sq//dtd html 2.0 hotmetal + extensions//',\n    '-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//',\n    '-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//',\n    '-//spyglass//dtd html 2.0 extended//',\n    '-//sun microsystems corp.//dtd hotjava html//',\n    '-//sun microsystems corp.//dtd hotjava strict html//',\n    '-//w3c//dtd html 3 1995-03-24//',\n    '-//w3c//dtd html 3.2 draft//',\n    '-//w3c//dtd html 3.2 final//',\n    '-//w3c//dtd html 3.2//',\n    '-//w3c//dtd html 3.2s draft//',\n    '-//w3c//dtd html 4.0 frameset//',\n    '-//w3c//dtd html 4.0 transitional//',\n    '-//w3c//dtd html experimental 19960712//',\n    '-//w3c//dtd html experimental 970421//',\n    '-//w3c//dtd w3 html//',\n    '-//w3o//dtd w3 html 3.0//',\n    '-//webtechs//dtd mozilla html 2.0//',\n    '-//webtechs//dtd mozilla html//'\n];\n\nconst QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES = QUIRKS_MODE_PUBLIC_ID_PREFIXES.concat([\n    '-//w3c//dtd html 4.01 frameset//',\n    '-//w3c//dtd html 4.01 transitional//'\n]);\n\nconst QUIRKS_MODE_PUBLIC_IDS = ['-//w3o//dtd w3 html strict 3.0//en//', '-/w3c/dtd html 4.0 transitional/en', 'html'];\nconst LIMITED_QUIRKS_PUBLIC_ID_PREFIXES = ['-//w3c//dtd xhtml 1.0 frameset//', '-//w3c//dtd xhtml 1.0 transitional//'];\n\nconst LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES = LIMITED_QUIRKS_PUBLIC_ID_PREFIXES.concat([\n    '-//w3c//dtd html 4.01 frameset//',\n    '-//w3c//dtd html 4.01 transitional//'\n]);\n\n//Utils\nfunction enquoteDoctypeId(id) {\n    const quote = id.indexOf('\"') !== -1 ? \"'\" : '\"';\n\n    return quote + id + quote;\n}\n\nfunction hasPrefix(publicId, prefixes) {\n    for (let i = 0; i < prefixes.length; i++) {\n        if (publicId.indexOf(prefixes[i]) === 0) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n//API\nexports.isConforming = function(token) {\n    return (\n        token.name === VALID_DOCTYPE_NAME &&\n        token.publicId === null &&\n        (token.systemId === null || token.systemId === VALID_SYSTEM_ID)\n    );\n};\n\nexports.getDocumentMode = function(token) {\n    if (token.name !== VALID_DOCTYPE_NAME) {\n        return DOCUMENT_MODE.QUIRKS;\n    }\n\n    const systemId = token.systemId;\n\n    if (systemId && systemId.toLowerCase() === QUIRKS_MODE_SYSTEM_ID) {\n        return DOCUMENT_MODE.QUIRKS;\n    }\n\n    let publicId = token.publicId;\n\n    if (publicId !== null) {\n        publicId = publicId.toLowerCase();\n\n        if (QUIRKS_MODE_PUBLIC_IDS.indexOf(publicId) > -1) {\n            return DOCUMENT_MODE.QUIRKS;\n        }\n\n        let prefixes = systemId === null ? QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES : QUIRKS_MODE_PUBLIC_ID_PREFIXES;\n\n        if (hasPrefix(publicId, prefixes)) {\n            return DOCUMENT_MODE.QUIRKS;\n        }\n\n        prefixes =\n            systemId === null ? LIMITED_QUIRKS_PUBLIC_ID_PREFIXES : LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES;\n\n        if (hasPrefix(publicId, prefixes)) {\n            return DOCUMENT_MODE.LIMITED_QUIRKS;\n        }\n    }\n\n    return DOCUMENT_MODE.NO_QUIRKS;\n};\n\nexports.serializeContent = function(name, publicId, systemId) {\n    let str = '!DOCTYPE ';\n\n    if (name) {\n        str += name;\n    }\n\n    if (publicId) {\n        str += ' PUBLIC ' + enquoteDoctypeId(publicId);\n    } else if (systemId) {\n        str += ' SYSTEM';\n    }\n\n    if (systemId !== null) {\n        str += ' ' + enquoteDoctypeId(systemId);\n    }\n\n    return str;\n};\n"]},"metadata":{},"sourceType":"script"}