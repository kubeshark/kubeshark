{"ast":null,"code":"'use strict';\n\nconst Tokenizer = require('../tokenizer');\n\nconst OpenElementStack = require('./open-element-stack');\n\nconst FormattingElementList = require('./formatting-element-list');\n\nconst LocationInfoParserMixin = require('../extensions/location-info/parser-mixin');\n\nconst ErrorReportingParserMixin = require('../extensions/error-reporting/parser-mixin');\n\nconst Mixin = require('../utils/mixin');\n\nconst defaultTreeAdapter = require('../tree-adapters/default');\n\nconst mergeOptions = require('../utils/merge-options');\n\nconst doctype = require('../common/doctype');\n\nconst foreignContent = require('../common/foreign-content');\n\nconst ERR = require('../common/error-codes');\n\nconst unicode = require('../common/unicode');\n\nconst HTML = require('../common/html'); //Aliases\n\n\nconst $ = HTML.TAG_NAMES;\nconst NS = HTML.NAMESPACES;\nconst ATTRS = HTML.ATTRS;\nconst DEFAULT_OPTIONS = {\n  scriptingEnabled: true,\n  sourceCodeLocationInfo: false,\n  onParseError: null,\n  treeAdapter: defaultTreeAdapter\n}; //Misc constants\n\nconst HIDDEN_INPUT_TYPE = 'hidden'; //Adoption agency loops iteration count\n\nconst AA_OUTER_LOOP_ITER = 8;\nconst AA_INNER_LOOP_ITER = 3; //Insertion modes\n\nconst INITIAL_MODE = 'INITIAL_MODE';\nconst BEFORE_HTML_MODE = 'BEFORE_HTML_MODE';\nconst BEFORE_HEAD_MODE = 'BEFORE_HEAD_MODE';\nconst IN_HEAD_MODE = 'IN_HEAD_MODE';\nconst IN_HEAD_NO_SCRIPT_MODE = 'IN_HEAD_NO_SCRIPT_MODE';\nconst AFTER_HEAD_MODE = 'AFTER_HEAD_MODE';\nconst IN_BODY_MODE = 'IN_BODY_MODE';\nconst TEXT_MODE = 'TEXT_MODE';\nconst IN_TABLE_MODE = 'IN_TABLE_MODE';\nconst IN_TABLE_TEXT_MODE = 'IN_TABLE_TEXT_MODE';\nconst IN_CAPTION_MODE = 'IN_CAPTION_MODE';\nconst IN_COLUMN_GROUP_MODE = 'IN_COLUMN_GROUP_MODE';\nconst IN_TABLE_BODY_MODE = 'IN_TABLE_BODY_MODE';\nconst IN_ROW_MODE = 'IN_ROW_MODE';\nconst IN_CELL_MODE = 'IN_CELL_MODE';\nconst IN_SELECT_MODE = 'IN_SELECT_MODE';\nconst IN_SELECT_IN_TABLE_MODE = 'IN_SELECT_IN_TABLE_MODE';\nconst IN_TEMPLATE_MODE = 'IN_TEMPLATE_MODE';\nconst AFTER_BODY_MODE = 'AFTER_BODY_MODE';\nconst IN_FRAMESET_MODE = 'IN_FRAMESET_MODE';\nconst AFTER_FRAMESET_MODE = 'AFTER_FRAMESET_MODE';\nconst AFTER_AFTER_BODY_MODE = 'AFTER_AFTER_BODY_MODE';\nconst AFTER_AFTER_FRAMESET_MODE = 'AFTER_AFTER_FRAMESET_MODE'; //Insertion mode reset map\n\nconst INSERTION_MODE_RESET_MAP = {\n  [$.TR]: IN_ROW_MODE,\n  [$.TBODY]: IN_TABLE_BODY_MODE,\n  [$.THEAD]: IN_TABLE_BODY_MODE,\n  [$.TFOOT]: IN_TABLE_BODY_MODE,\n  [$.CAPTION]: IN_CAPTION_MODE,\n  [$.COLGROUP]: IN_COLUMN_GROUP_MODE,\n  [$.TABLE]: IN_TABLE_MODE,\n  [$.BODY]: IN_BODY_MODE,\n  [$.FRAMESET]: IN_FRAMESET_MODE\n}; //Template insertion mode switch map\n\nconst TEMPLATE_INSERTION_MODE_SWITCH_MAP = {\n  [$.CAPTION]: IN_TABLE_MODE,\n  [$.COLGROUP]: IN_TABLE_MODE,\n  [$.TBODY]: IN_TABLE_MODE,\n  [$.TFOOT]: IN_TABLE_MODE,\n  [$.THEAD]: IN_TABLE_MODE,\n  [$.COL]: IN_COLUMN_GROUP_MODE,\n  [$.TR]: IN_TABLE_BODY_MODE,\n  [$.TD]: IN_ROW_MODE,\n  [$.TH]: IN_ROW_MODE\n}; //Token handlers map for insertion modes\n\nconst TOKEN_HANDLERS = {\n  [INITIAL_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInInitialMode,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInInitialMode,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: doctypeInInitialMode,\n    [Tokenizer.START_TAG_TOKEN]: tokenInInitialMode,\n    [Tokenizer.END_TAG_TOKEN]: tokenInInitialMode,\n    [Tokenizer.EOF_TOKEN]: tokenInInitialMode\n  },\n  [BEFORE_HTML_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHtml,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHtml,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagBeforeHtml,\n    [Tokenizer.END_TAG_TOKEN]: endTagBeforeHtml,\n    [Tokenizer.EOF_TOKEN]: tokenBeforeHtml\n  },\n  [BEFORE_HEAD_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHead,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHead,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagBeforeHead,\n    [Tokenizer.END_TAG_TOKEN]: endTagBeforeHead,\n    [Tokenizer.EOF_TOKEN]: tokenBeforeHead\n  },\n  [IN_HEAD_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInHead,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHead,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagInHead,\n    [Tokenizer.END_TAG_TOKEN]: endTagInHead,\n    [Tokenizer.EOF_TOKEN]: tokenInHead\n  },\n  [IN_HEAD_NO_SCRIPT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInHeadNoScript,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHeadNoScript,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagInHeadNoScript,\n    [Tokenizer.END_TAG_TOKEN]: endTagInHeadNoScript,\n    [Tokenizer.EOF_TOKEN]: tokenInHeadNoScript\n  },\n  [AFTER_HEAD_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenAfterHead,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterHead,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterHead,\n    [Tokenizer.END_TAG_TOKEN]: endTagAfterHead,\n    [Tokenizer.EOF_TOKEN]: tokenAfterHead\n  },\n  [IN_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInBody,\n    [Tokenizer.END_TAG_TOKEN]: endTagInBody,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [TEXT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: ignoreToken,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: ignoreToken,\n    [Tokenizer.END_TAG_TOKEN]: endTagInText,\n    [Tokenizer.EOF_TOKEN]: eofInText\n  },\n  [IN_TABLE_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInTable,\n    [Tokenizer.END_TAG_TOKEN]: endTagInTable,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_TABLE_TEXT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTableText,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInTableText,\n    [Tokenizer.COMMENT_TOKEN]: tokenInTableText,\n    [Tokenizer.DOCTYPE_TOKEN]: tokenInTableText,\n    [Tokenizer.START_TAG_TOKEN]: tokenInTableText,\n    [Tokenizer.END_TAG_TOKEN]: tokenInTableText,\n    [Tokenizer.EOF_TOKEN]: tokenInTableText\n  },\n  [IN_CAPTION_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInCaption,\n    [Tokenizer.END_TAG_TOKEN]: endTagInCaption,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_COLUMN_GROUP_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInColumnGroup,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInColumnGroup,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInColumnGroup,\n    [Tokenizer.END_TAG_TOKEN]: endTagInColumnGroup,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_TABLE_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInTableBody,\n    [Tokenizer.END_TAG_TOKEN]: endTagInTableBody,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_ROW_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInRow,\n    [Tokenizer.END_TAG_TOKEN]: endTagInRow,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_CELL_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInCell,\n    [Tokenizer.END_TAG_TOKEN]: endTagInCell,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_SELECT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInSelect,\n    [Tokenizer.END_TAG_TOKEN]: endTagInSelect,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_SELECT_IN_TABLE_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInSelectInTable,\n    [Tokenizer.END_TAG_TOKEN]: endTagInSelectInTable,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_TEMPLATE_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInTemplate,\n    [Tokenizer.END_TAG_TOKEN]: endTagInTemplate,\n    [Tokenizer.EOF_TOKEN]: eofInTemplate\n  },\n  [AFTER_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenAfterBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterBody,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendCommentToRootHtmlElement,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterBody,\n    [Tokenizer.END_TAG_TOKEN]: endTagAfterBody,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [IN_FRAMESET_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInFrameset,\n    [Tokenizer.END_TAG_TOKEN]: endTagInFrameset,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [AFTER_FRAMESET_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterFrameset,\n    [Tokenizer.END_TAG_TOKEN]: endTagAfterFrameset,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [AFTER_AFTER_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenAfterAfterBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterAfterBody,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterBody,\n    [Tokenizer.END_TAG_TOKEN]: tokenAfterAfterBody,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [AFTER_AFTER_FRAMESET_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterFrameset,\n    [Tokenizer.END_TAG_TOKEN]: ignoreToken,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  }\n}; //Parser\n\nclass Parser {\n  constructor(options) {\n    this.options = mergeOptions(DEFAULT_OPTIONS, options);\n    this.treeAdapter = this.options.treeAdapter;\n    this.pendingScript = null;\n\n    if (this.options.sourceCodeLocationInfo) {\n      Mixin.install(this, LocationInfoParserMixin);\n    }\n\n    if (this.options.onParseError) {\n      Mixin.install(this, ErrorReportingParserMixin, {\n        onParseError: this.options.onParseError\n      });\n    }\n  } // API\n\n\n  parse(html) {\n    const document = this.treeAdapter.createDocument();\n\n    this._bootstrap(document, null);\n\n    this.tokenizer.write(html, true);\n\n    this._runParsingLoop(null);\n\n    return document;\n  }\n\n  parseFragment(html, fragmentContext) {\n    //NOTE: use <template> element as a fragment context if context element was not provided,\n    //so we will parse in \"forgiving\" manner\n    if (!fragmentContext) {\n      fragmentContext = this.treeAdapter.createElement($.TEMPLATE, NS.HTML, []);\n    } //NOTE: create fake element which will be used as 'document' for fragment parsing.\n    //This is important for jsdom there 'document' can't be recreated, therefore\n    //fragment parsing causes messing of the main `document`.\n\n\n    const documentMock = this.treeAdapter.createElement('documentmock', NS.HTML, []);\n\n    this._bootstrap(documentMock, fragmentContext);\n\n    if (this.treeAdapter.getTagName(fragmentContext) === $.TEMPLATE) {\n      this._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n    }\n\n    this._initTokenizerForFragmentParsing();\n\n    this._insertFakeRootElement();\n\n    this._resetInsertionMode();\n\n    this._findFormInFragmentContext();\n\n    this.tokenizer.write(html, true);\n\n    this._runParsingLoop(null);\n\n    const rootElement = this.treeAdapter.getFirstChild(documentMock);\n    const fragment = this.treeAdapter.createDocumentFragment();\n\n    this._adoptNodes(rootElement, fragment);\n\n    return fragment;\n  } //Bootstrap parser\n\n\n  _bootstrap(document, fragmentContext) {\n    this.tokenizer = new Tokenizer(this.options);\n    this.stopped = false;\n    this.insertionMode = INITIAL_MODE;\n    this.originalInsertionMode = '';\n    this.document = document;\n    this.fragmentContext = fragmentContext;\n    this.headElement = null;\n    this.formElement = null;\n    this.openElements = new OpenElementStack(this.document, this.treeAdapter);\n    this.activeFormattingElements = new FormattingElementList(this.treeAdapter);\n    this.tmplInsertionModeStack = [];\n    this.tmplInsertionModeStackTop = -1;\n    this.currentTmplInsertionMode = null;\n    this.pendingCharacterTokens = [];\n    this.hasNonWhitespacePendingCharacterToken = false;\n    this.framesetOk = true;\n    this.skipNextNewLine = false;\n    this.fosterParentingEnabled = false;\n  } //Errors\n\n\n  _err() {// NOTE: err reporting is noop by default. Enabled by mixin.\n  } //Parsing loop\n\n\n  _runParsingLoop(scriptHandler) {\n    while (!this.stopped) {\n      this._setupTokenizerCDATAMode();\n\n      const token = this.tokenizer.getNextToken();\n\n      if (token.type === Tokenizer.HIBERNATION_TOKEN) {\n        break;\n      }\n\n      if (this.skipNextNewLine) {\n        this.skipNextNewLine = false;\n\n        if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n          if (token.chars.length === 1) {\n            continue;\n          }\n\n          token.chars = token.chars.substr(1);\n        }\n      }\n\n      this._processInputToken(token);\n\n      if (scriptHandler && this.pendingScript) {\n        break;\n      }\n    }\n  }\n\n  runParsingLoopForCurrentChunk(writeCallback, scriptHandler) {\n    this._runParsingLoop(scriptHandler);\n\n    if (scriptHandler && this.pendingScript) {\n      const script = this.pendingScript;\n      this.pendingScript = null;\n      scriptHandler(script);\n      return;\n    }\n\n    if (writeCallback) {\n      writeCallback();\n    }\n  } //Text parsing\n\n\n  _setupTokenizerCDATAMode() {\n    const current = this._getAdjustedCurrentElement();\n\n    this.tokenizer.allowCDATA = current && current !== this.document && this.treeAdapter.getNamespaceURI(current) !== NS.HTML && !this._isIntegrationPoint(current);\n  }\n\n  _switchToTextParsing(currentToken, nextTokenizerState) {\n    this._insertElement(currentToken, NS.HTML);\n\n    this.tokenizer.state = nextTokenizerState;\n    this.originalInsertionMode = this.insertionMode;\n    this.insertionMode = TEXT_MODE;\n  }\n\n  switchToPlaintextParsing() {\n    this.insertionMode = TEXT_MODE;\n    this.originalInsertionMode = IN_BODY_MODE;\n    this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n  } //Fragment parsing\n\n\n  _getAdjustedCurrentElement() {\n    return this.openElements.stackTop === 0 && this.fragmentContext ? this.fragmentContext : this.openElements.current;\n  }\n\n  _findFormInFragmentContext() {\n    let node = this.fragmentContext;\n\n    do {\n      if (this.treeAdapter.getTagName(node) === $.FORM) {\n        this.formElement = node;\n        break;\n      }\n\n      node = this.treeAdapter.getParentNode(node);\n    } while (node);\n  }\n\n  _initTokenizerForFragmentParsing() {\n    if (this.treeAdapter.getNamespaceURI(this.fragmentContext) === NS.HTML) {\n      const tn = this.treeAdapter.getTagName(this.fragmentContext);\n\n      if (tn === $.TITLE || tn === $.TEXTAREA) {\n        this.tokenizer.state = Tokenizer.MODE.RCDATA;\n      } else if (tn === $.STYLE || tn === $.XMP || tn === $.IFRAME || tn === $.NOEMBED || tn === $.NOFRAMES || tn === $.NOSCRIPT) {\n        this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n      } else if (tn === $.SCRIPT) {\n        this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;\n      } else if (tn === $.PLAINTEXT) {\n        this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n      }\n    }\n  } //Tree mutation\n\n\n  _setDocumentType(token) {\n    const name = token.name || '';\n    const publicId = token.publicId || '';\n    const systemId = token.systemId || '';\n    this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n  }\n\n  _attachElementToTree(element) {\n    if (this._shouldFosterParentOnInsertion()) {\n      this._fosterParentElement(element);\n    } else {\n      const parent = this.openElements.currentTmplContent || this.openElements.current;\n      this.treeAdapter.appendChild(parent, element);\n    }\n  }\n\n  _appendElement(token, namespaceURI) {\n    const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n    this._attachElementToTree(element);\n  }\n\n  _insertElement(token, namespaceURI) {\n    const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n    this._attachElementToTree(element);\n\n    this.openElements.push(element);\n  }\n\n  _insertFakeElement(tagName) {\n    const element = this.treeAdapter.createElement(tagName, NS.HTML, []);\n\n    this._attachElementToTree(element);\n\n    this.openElements.push(element);\n  }\n\n  _insertTemplate(token) {\n    const tmpl = this.treeAdapter.createElement(token.tagName, NS.HTML, token.attrs);\n    const content = this.treeAdapter.createDocumentFragment();\n    this.treeAdapter.setTemplateContent(tmpl, content);\n\n    this._attachElementToTree(tmpl);\n\n    this.openElements.push(tmpl);\n  }\n\n  _insertFakeRootElement() {\n    const element = this.treeAdapter.createElement($.HTML, NS.HTML, []);\n    this.treeAdapter.appendChild(this.openElements.current, element);\n    this.openElements.push(element);\n  }\n\n  _appendCommentNode(token, parent) {\n    const commentNode = this.treeAdapter.createCommentNode(token.data);\n    this.treeAdapter.appendChild(parent, commentNode);\n  }\n\n  _insertCharacters(token) {\n    if (this._shouldFosterParentOnInsertion()) {\n      this._fosterParentText(token.chars);\n    } else {\n      const parent = this.openElements.currentTmplContent || this.openElements.current;\n      this.treeAdapter.insertText(parent, token.chars);\n    }\n  }\n\n  _adoptNodes(donor, recipient) {\n    for (let child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n      this.treeAdapter.detachNode(child);\n      this.treeAdapter.appendChild(recipient, child);\n    }\n  } //Token processing\n\n\n  _shouldProcessTokenInForeignContent(token) {\n    const current = this._getAdjustedCurrentElement();\n\n    if (!current || current === this.document) {\n      return false;\n    }\n\n    const ns = this.treeAdapter.getNamespaceURI(current);\n\n    if (ns === NS.HTML) {\n      return false;\n    }\n\n    if (this.treeAdapter.getTagName(current) === $.ANNOTATION_XML && ns === NS.MATHML && token.type === Tokenizer.START_TAG_TOKEN && token.tagName === $.SVG) {\n      return false;\n    }\n\n    const isCharacterToken = token.type === Tokenizer.CHARACTER_TOKEN || token.type === Tokenizer.NULL_CHARACTER_TOKEN || token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN;\n    const isMathMLTextStartTag = token.type === Tokenizer.START_TAG_TOKEN && token.tagName !== $.MGLYPH && token.tagName !== $.MALIGNMARK;\n\n    if ((isMathMLTextStartTag || isCharacterToken) && this._isIntegrationPoint(current, NS.MATHML)) {\n      return false;\n    }\n\n    if ((token.type === Tokenizer.START_TAG_TOKEN || isCharacterToken) && this._isIntegrationPoint(current, NS.HTML)) {\n      return false;\n    }\n\n    return token.type !== Tokenizer.EOF_TOKEN;\n  }\n\n  _processToken(token) {\n    TOKEN_HANDLERS[this.insertionMode][token.type](this, token);\n  }\n\n  _processTokenInBodyMode(token) {\n    TOKEN_HANDLERS[IN_BODY_MODE][token.type](this, token);\n  }\n\n  _processTokenInForeignContent(token) {\n    if (token.type === Tokenizer.CHARACTER_TOKEN) {\n      characterInForeignContent(this, token);\n    } else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\n      nullCharacterInForeignContent(this, token);\n    } else if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN) {\n      insertCharacters(this, token);\n    } else if (token.type === Tokenizer.COMMENT_TOKEN) {\n      appendComment(this, token);\n    } else if (token.type === Tokenizer.START_TAG_TOKEN) {\n      startTagInForeignContent(this, token);\n    } else if (token.type === Tokenizer.END_TAG_TOKEN) {\n      endTagInForeignContent(this, token);\n    }\n  }\n\n  _processInputToken(token) {\n    if (this._shouldProcessTokenInForeignContent(token)) {\n      this._processTokenInForeignContent(token);\n    } else {\n      this._processToken(token);\n    }\n\n    if (token.type === Tokenizer.START_TAG_TOKEN && token.selfClosing && !token.ackSelfClosing) {\n      this._err(ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n    }\n  } //Integration points\n\n\n  _isIntegrationPoint(element, foreignNS) {\n    const tn = this.treeAdapter.getTagName(element);\n    const ns = this.treeAdapter.getNamespaceURI(element);\n    const attrs = this.treeAdapter.getAttrList(element);\n    return foreignContent.isIntegrationPoint(tn, ns, attrs, foreignNS);\n  } //Active formatting elements reconstruction\n\n\n  _reconstructActiveFormattingElements() {\n    const listLength = this.activeFormattingElements.length;\n\n    if (listLength) {\n      let unopenIdx = listLength;\n      let entry = null;\n\n      do {\n        unopenIdx--;\n        entry = this.activeFormattingElements.entries[unopenIdx];\n\n        if (entry.type === FormattingElementList.MARKER_ENTRY || this.openElements.contains(entry.element)) {\n          unopenIdx++;\n          break;\n        }\n      } while (unopenIdx > 0);\n\n      for (let i = unopenIdx; i < listLength; i++) {\n        entry = this.activeFormattingElements.entries[i];\n\n        this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n\n        entry.element = this.openElements.current;\n      }\n    }\n  } //Close elements\n\n\n  _closeTableCell() {\n    this.openElements.generateImpliedEndTags();\n    this.openElements.popUntilTableCellPopped();\n    this.activeFormattingElements.clearToLastMarker();\n    this.insertionMode = IN_ROW_MODE;\n  }\n\n  _closePElement() {\n    this.openElements.generateImpliedEndTagsWithExclusion($.P);\n    this.openElements.popUntilTagNamePopped($.P);\n  } //Insertion modes\n\n\n  _resetInsertionMode() {\n    for (let i = this.openElements.stackTop, last = false; i >= 0; i--) {\n      let element = this.openElements.items[i];\n\n      if (i === 0) {\n        last = true;\n\n        if (this.fragmentContext) {\n          element = this.fragmentContext;\n        }\n      }\n\n      const tn = this.treeAdapter.getTagName(element);\n      const newInsertionMode = INSERTION_MODE_RESET_MAP[tn];\n\n      if (newInsertionMode) {\n        this.insertionMode = newInsertionMode;\n        break;\n      } else if (!last && (tn === $.TD || tn === $.TH)) {\n        this.insertionMode = IN_CELL_MODE;\n        break;\n      } else if (!last && tn === $.HEAD) {\n        this.insertionMode = IN_HEAD_MODE;\n        break;\n      } else if (tn === $.SELECT) {\n        this._resetInsertionModeForSelect(i);\n\n        break;\n      } else if (tn === $.TEMPLATE) {\n        this.insertionMode = this.currentTmplInsertionMode;\n        break;\n      } else if (tn === $.HTML) {\n        this.insertionMode = this.headElement ? AFTER_HEAD_MODE : BEFORE_HEAD_MODE;\n        break;\n      } else if (last) {\n        this.insertionMode = IN_BODY_MODE;\n        break;\n      }\n    }\n  }\n\n  _resetInsertionModeForSelect(selectIdx) {\n    if (selectIdx > 0) {\n      for (let i = selectIdx - 1; i > 0; i--) {\n        const ancestor = this.openElements.items[i];\n        const tn = this.treeAdapter.getTagName(ancestor);\n\n        if (tn === $.TEMPLATE) {\n          break;\n        } else if (tn === $.TABLE) {\n          this.insertionMode = IN_SELECT_IN_TABLE_MODE;\n          return;\n        }\n      }\n    }\n\n    this.insertionMode = IN_SELECT_MODE;\n  }\n\n  _pushTmplInsertionMode(mode) {\n    this.tmplInsertionModeStack.push(mode);\n    this.tmplInsertionModeStackTop++;\n    this.currentTmplInsertionMode = mode;\n  }\n\n  _popTmplInsertionMode() {\n    this.tmplInsertionModeStack.pop();\n    this.tmplInsertionModeStackTop--;\n    this.currentTmplInsertionMode = this.tmplInsertionModeStack[this.tmplInsertionModeStackTop];\n  } //Foster parenting\n\n\n  _isElementCausesFosterParenting(element) {\n    const tn = this.treeAdapter.getTagName(element);\n    return tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR;\n  }\n\n  _shouldFosterParentOnInsertion() {\n    return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.current);\n  }\n\n  _findFosterParentingLocation() {\n    const location = {\n      parent: null,\n      beforeElement: null\n    };\n\n    for (let i = this.openElements.stackTop; i >= 0; i--) {\n      const openElement = this.openElements.items[i];\n      const tn = this.treeAdapter.getTagName(openElement);\n      const ns = this.treeAdapter.getNamespaceURI(openElement);\n\n      if (tn === $.TEMPLATE && ns === NS.HTML) {\n        location.parent = this.treeAdapter.getTemplateContent(openElement);\n        break;\n      } else if (tn === $.TABLE) {\n        location.parent = this.treeAdapter.getParentNode(openElement);\n\n        if (location.parent) {\n          location.beforeElement = openElement;\n        } else {\n          location.parent = this.openElements.items[i - 1];\n        }\n\n        break;\n      }\n    }\n\n    if (!location.parent) {\n      location.parent = this.openElements.items[0];\n    }\n\n    return location;\n  }\n\n  _fosterParentElement(element) {\n    const location = this._findFosterParentingLocation();\n\n    if (location.beforeElement) {\n      this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n    } else {\n      this.treeAdapter.appendChild(location.parent, element);\n    }\n  }\n\n  _fosterParentText(chars) {\n    const location = this._findFosterParentingLocation();\n\n    if (location.beforeElement) {\n      this.treeAdapter.insertTextBefore(location.parent, chars, location.beforeElement);\n    } else {\n      this.treeAdapter.insertText(location.parent, chars);\n    }\n  } //Special elements\n\n\n  _isSpecialElement(element) {\n    const tn = this.treeAdapter.getTagName(element);\n    const ns = this.treeAdapter.getNamespaceURI(element);\n    return HTML.SPECIAL_ELEMENTS[ns][tn];\n  }\n\n}\n\nmodule.exports = Parser; //Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n//Steps 5-8 of the algorithm\n\nfunction aaObtainFormattingElementEntry(p, token) {\n  let formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n\n  if (formattingElementEntry) {\n    if (!p.openElements.contains(formattingElementEntry.element)) {\n      p.activeFormattingElements.removeEntry(formattingElementEntry);\n      formattingElementEntry = null;\n    } else if (!p.openElements.hasInScope(token.tagName)) {\n      formattingElementEntry = null;\n    }\n  } else {\n    genericEndTagInBody(p, token);\n  }\n\n  return formattingElementEntry;\n} //Steps 9 and 10 of the algorithm\n\n\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n  let furthestBlock = null;\n\n  for (let i = p.openElements.stackTop; i >= 0; i--) {\n    const element = p.openElements.items[i];\n\n    if (element === formattingElementEntry.element) {\n      break;\n    }\n\n    if (p._isSpecialElement(element)) {\n      furthestBlock = element;\n    }\n  }\n\n  if (!furthestBlock) {\n    p.openElements.popUntilElementPopped(formattingElementEntry.element);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n  }\n\n  return furthestBlock;\n} //Step 13 of the algorithm\n\n\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n  let lastElement = furthestBlock;\n  let nextElement = p.openElements.getCommonAncestor(furthestBlock);\n\n  for (let i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n    //NOTE: store next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n    nextElement = p.openElements.getCommonAncestor(element);\n    const elementEntry = p.activeFormattingElements.getElementEntry(element);\n    const counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n    const shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n\n    if (shouldRemoveFromOpenElements) {\n      if (counterOverflow) {\n        p.activeFormattingElements.removeEntry(elementEntry);\n      }\n\n      p.openElements.remove(element);\n    } else {\n      element = aaRecreateElementFromEntry(p, elementEntry);\n\n      if (lastElement === furthestBlock) {\n        p.activeFormattingElements.bookmark = elementEntry;\n      }\n\n      p.treeAdapter.detachNode(lastElement);\n      p.treeAdapter.appendChild(element, lastElement);\n      lastElement = element;\n    }\n  }\n\n  return lastElement;\n} //Step 13.7 of the algorithm\n\n\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n  const ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n  const newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n  p.openElements.replace(elementEntry.element, newElement);\n  elementEntry.element = newElement;\n  return newElement;\n} //Step 14 of the algorithm\n\n\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n  if (p._isElementCausesFosterParenting(commonAncestor)) {\n    p._fosterParentElement(lastElement);\n  } else {\n    const tn = p.treeAdapter.getTagName(commonAncestor);\n    const ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n\n    if (tn === $.TEMPLATE && ns === NS.HTML) {\n      commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n    }\n\n    p.treeAdapter.appendChild(commonAncestor, lastElement);\n  }\n} //Steps 15-19 of the algorithm\n\n\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n  const ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n  const token = formattingElementEntry.token;\n  const newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n\n  p._adoptNodes(furthestBlock, newElement);\n\n  p.treeAdapter.appendChild(furthestBlock, newElement);\n  p.activeFormattingElements.insertElementAfterBookmark(newElement, formattingElementEntry.token);\n  p.activeFormattingElements.removeEntry(formattingElementEntry);\n  p.openElements.remove(formattingElementEntry.element);\n  p.openElements.insertAfter(furthestBlock, newElement);\n} //Algorithm entry point\n\n\nfunction callAdoptionAgency(p, token) {\n  let formattingElementEntry;\n\n  for (let i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n    formattingElementEntry = aaObtainFormattingElementEntry(p, token, formattingElementEntry);\n\n    if (!formattingElementEntry) {\n      break;\n    }\n\n    const furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n\n    if (!furthestBlock) {\n      break;\n    }\n\n    p.activeFormattingElements.bookmark = formattingElementEntry;\n    const lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n    const commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n    p.treeAdapter.detachNode(lastElement);\n    aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n    aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n  }\n} //Generic token handlers\n//------------------------------------------------------------------\n\n\nfunction ignoreToken() {//NOTE: do nothing =)\n}\n\nfunction misplacedDoctype(p) {\n  p._err(ERR.misplacedDoctype);\n}\n\nfunction appendComment(p, token) {\n  p._appendCommentNode(token, p.openElements.currentTmplContent || p.openElements.current);\n}\n\nfunction appendCommentToRootHtmlElement(p, token) {\n  p._appendCommentNode(token, p.openElements.items[0]);\n}\n\nfunction appendCommentToDocument(p, token) {\n  p._appendCommentNode(token, p.document);\n}\n\nfunction insertCharacters(p, token) {\n  p._insertCharacters(token);\n}\n\nfunction stopParsing(p) {\n  p.stopped = true;\n} // The \"initial\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction doctypeInInitialMode(p, token) {\n  p._setDocumentType(token);\n\n  const mode = token.forceQuirks ? HTML.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n\n  if (!doctype.isConforming(token)) {\n    p._err(ERR.nonConformingDoctype);\n  }\n\n  p.treeAdapter.setDocumentMode(p.document, mode);\n  p.insertionMode = BEFORE_HTML_MODE;\n}\n\nfunction tokenInInitialMode(p, token) {\n  p._err(ERR.missingDoctype, {\n    beforeToken: true\n  });\n\n  p.treeAdapter.setDocumentMode(p.document, HTML.DOCUMENT_MODE.QUIRKS);\n  p.insertionMode = BEFORE_HTML_MODE;\n\n  p._processToken(token);\n} // The \"before html\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagBeforeHtml(p, token) {\n  if (token.tagName === $.HTML) {\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = BEFORE_HEAD_MODE;\n  } else {\n    tokenBeforeHtml(p, token);\n  }\n}\n\nfunction endTagBeforeHtml(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML || tn === $.HEAD || tn === $.BODY || tn === $.BR) {\n    tokenBeforeHtml(p, token);\n  }\n}\n\nfunction tokenBeforeHtml(p, token) {\n  p._insertFakeRootElement();\n\n  p.insertionMode = BEFORE_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"before head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagBeforeHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.HEAD) {\n    p._insertElement(token, NS.HTML);\n\n    p.headElement = p.openElements.current;\n    p.insertionMode = IN_HEAD_MODE;\n  } else {\n    tokenBeforeHead(p, token);\n  }\n}\n\nfunction endTagBeforeHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HEAD || tn === $.BODY || tn === $.HTML || tn === $.BR) {\n    tokenBeforeHead(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenBeforeHead(p, token) {\n  p._insertFakeElement($.HEAD);\n\n  p.headElement = p.openElements.current;\n  p.insertionMode = IN_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"in head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.TITLE) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RCDATA);\n  } else if (tn === $.NOSCRIPT) {\n    if (p.options.scriptingEnabled) {\n      p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n    } else {\n      p._insertElement(token, NS.HTML);\n\n      p.insertionMode = IN_HEAD_NO_SCRIPT_MODE;\n    }\n  } else if (tn === $.NOFRAMES || tn === $.STYLE) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n  } else if (tn === $.SCRIPT) {\n    p._switchToTextParsing(token, Tokenizer.MODE.SCRIPT_DATA);\n  } else if (tn === $.TEMPLATE) {\n    p._insertTemplate(token, NS.HTML);\n\n    p.activeFormattingElements.insertMarker();\n    p.framesetOk = false;\n    p.insertionMode = IN_TEMPLATE_MODE;\n\n    p._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n  } else if (tn === $.HEAD) {\n    p._err(ERR.misplacedStartTagForHeadElement);\n  } else {\n    tokenInHead(p, token);\n  }\n}\n\nfunction endTagInHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HEAD) {\n    p.openElements.pop();\n    p.insertionMode = AFTER_HEAD_MODE;\n  } else if (tn === $.BODY || tn === $.BR || tn === $.HTML) {\n    tokenInHead(p, token);\n  } else if (tn === $.TEMPLATE) {\n    if (p.openElements.tmplCount > 0) {\n      p.openElements.generateImpliedEndTagsThoroughly();\n\n      if (p.openElements.currentTagName !== $.TEMPLATE) {\n        p._err(ERR.closingOfElementWithOpenChildElements);\n      }\n\n      p.openElements.popUntilTagNamePopped($.TEMPLATE);\n      p.activeFormattingElements.clearToLastMarker();\n\n      p._popTmplInsertionMode();\n\n      p._resetInsertionMode();\n    } else {\n      p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenInHead(p, token) {\n  p.openElements.pop();\n  p.insertionMode = AFTER_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"in head no script\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInHeadNoScript(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BASEFONT || tn === $.BGSOUND || tn === $.HEAD || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.STYLE) {\n    startTagInHead(p, token);\n  } else if (tn === $.NOSCRIPT) {\n    p._err(ERR.nestedNoscriptInHead);\n  } else {\n    tokenInHeadNoScript(p, token);\n  }\n}\n\nfunction endTagInHeadNoScript(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.NOSCRIPT) {\n    p.openElements.pop();\n    p.insertionMode = IN_HEAD_MODE;\n  } else if (tn === $.BR) {\n    tokenInHeadNoScript(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenInHeadNoScript(p, token) {\n  const errCode = token.type === Tokenizer.EOF_TOKEN ? ERR.openElementsLeftAfterEof : ERR.disallowedContentInNoscriptInHead;\n\n  p._err(errCode);\n\n  p.openElements.pop();\n  p.insertionMode = IN_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"after head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BODY) {\n    p._insertElement(token, NS.HTML);\n\n    p.framesetOk = false;\n    p.insertionMode = IN_BODY_MODE;\n  } else if (tn === $.FRAMESET) {\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_FRAMESET_MODE;\n  } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.SCRIPT || tn === $.STYLE || tn === $.TEMPLATE || tn === $.TITLE) {\n    p._err(ERR.abandonedHeadElementChild);\n\n    p.openElements.push(p.headElement);\n    startTagInHead(p, token);\n    p.openElements.remove(p.headElement);\n  } else if (tn === $.HEAD) {\n    p._err(ERR.misplacedStartTagForHeadElement);\n  } else {\n    tokenAfterHead(p, token);\n  }\n}\n\nfunction endTagAfterHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.BODY || tn === $.HTML || tn === $.BR) {\n    tokenAfterHead(p, token);\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenAfterHead(p, token) {\n  p._insertFakeElement($.BODY);\n\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"in body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction whitespaceCharacterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertCharacters(token);\n}\n\nfunction characterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertCharacters(token);\n\n  p.framesetOk = false;\n}\n\nfunction htmlStartTagInBody(p, token) {\n  if (p.openElements.tmplCount === 0) {\n    p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n  }\n}\n\nfunction bodyStartTagInBody(p, token) {\n  const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n  if (bodyElement && p.openElements.tmplCount === 0) {\n    p.framesetOk = false;\n    p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n  }\n}\n\nfunction framesetStartTagInBody(p, token) {\n  const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n  if (p.framesetOk && bodyElement) {\n    p.treeAdapter.detachNode(bodyElement);\n    p.openElements.popAllUpToHtmlElement();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_FRAMESET_MODE;\n  }\n}\n\nfunction addressStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction numberedHeaderStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  const tn = p.openElements.currentTagName;\n\n  if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n    p.openElements.pop();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction preStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML); //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n\n\n  p.skipNextNewLine = true;\n  p.framesetOk = false;\n}\n\nfunction formStartTagInBody(p, token) {\n  const inTemplate = p.openElements.tmplCount > 0;\n\n  if (!p.formElement || inTemplate) {\n    if (p.openElements.hasInButtonScope($.P)) {\n      p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n\n    if (!inTemplate) {\n      p.formElement = p.openElements.current;\n    }\n  }\n}\n\nfunction listItemStartTagInBody(p, token) {\n  p.framesetOk = false;\n  const tn = token.tagName;\n\n  for (let i = p.openElements.stackTop; i >= 0; i--) {\n    const element = p.openElements.items[i];\n    const elementTn = p.treeAdapter.getTagName(element);\n    let closeTn = null;\n\n    if (tn === $.LI && elementTn === $.LI) {\n      closeTn = $.LI;\n    } else if ((tn === $.DD || tn === $.DT) && (elementTn === $.DD || elementTn === $.DT)) {\n      closeTn = elementTn;\n    }\n\n    if (closeTn) {\n      p.openElements.generateImpliedEndTagsWithExclusion(closeTn);\n      p.openElements.popUntilTagNamePopped(closeTn);\n      break;\n    }\n\n    if (elementTn !== $.ADDRESS && elementTn !== $.DIV && elementTn !== $.P && p._isSpecialElement(element)) {\n      break;\n    }\n  }\n\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction plaintextStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n}\n\nfunction buttonStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.BUTTON)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped($.BUTTON);\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n}\n\nfunction aStartTagInBody(p, token) {\n  const activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName($.A);\n\n  if (activeElementEntry) {\n    callAdoptionAgency(p, token);\n    p.openElements.remove(activeElementEntry.element);\n    p.activeFormattingElements.removeEntry(activeElementEntry);\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction bStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction nobrStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  if (p.openElements.hasInScope($.NOBR)) {\n    callAdoptionAgency(p, token);\n\n    p._reconstructActiveFormattingElements();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction appletStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.insertMarker();\n  p.framesetOk = false;\n}\n\nfunction tableStartTagInBody(p, token) {\n  if (p.treeAdapter.getDocumentMode(p.document) !== HTML.DOCUMENT_MODE.QUIRKS && p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  p.insertionMode = IN_TABLE_MODE;\n}\n\nfunction areaStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._appendElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\n\nfunction inputStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._appendElement(token, NS.HTML);\n\n  const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n  if (!inputType || inputType.toLowerCase() !== HIDDEN_INPUT_TYPE) {\n    p.framesetOk = false;\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction paramStartTagInBody(p, token) {\n  p._appendElement(token, NS.HTML);\n\n  token.ackSelfClosing = true;\n}\n\nfunction hrStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._appendElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\n\nfunction imageStartTagInBody(p, token) {\n  token.tagName = $.IMG;\n  areaStartTagInBody(p, token);\n}\n\nfunction textareaStartTagInBody(p, token) {\n  p._insertElement(token, NS.HTML); //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n\n\n  p.skipNextNewLine = true;\n  p.tokenizer.state = Tokenizer.MODE.RCDATA;\n  p.originalInsertionMode = p.insertionMode;\n  p.framesetOk = false;\n  p.insertionMode = TEXT_MODE;\n}\n\nfunction xmpStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p.framesetOk = false;\n\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction iframeStartTagInBody(p, token) {\n  p.framesetOk = false;\n\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n} //NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as a rawtext.\n\n\nfunction noembedStartTagInBody(p, token) {\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction selectStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n\n  if (p.insertionMode === IN_TABLE_MODE || p.insertionMode === IN_CAPTION_MODE || p.insertionMode === IN_TABLE_BODY_MODE || p.insertionMode === IN_ROW_MODE || p.insertionMode === IN_CELL_MODE) {\n    p.insertionMode = IN_SELECT_IN_TABLE_MODE;\n  } else {\n    p.insertionMode = IN_SELECT_MODE;\n  }\n}\n\nfunction optgroupStartTagInBody(p, token) {\n  if (p.openElements.currentTagName === $.OPTION) {\n    p.openElements.pop();\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction rbStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.RUBY)) {\n    p.openElements.generateImpliedEndTags();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction rtStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.RUBY)) {\n    p.openElements.generateImpliedEndTagsWithExclusion($.RTC);\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction menuStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction mathStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  foreignContent.adjustTokenMathMLAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n\n  if (token.selfClosing) {\n    p._appendElement(token, NS.MATHML);\n  } else {\n    p._insertElement(token, NS.MATHML);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction svgStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  foreignContent.adjustTokenSVGAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n\n  if (token.selfClosing) {\n    p._appendElement(token, NS.SVG);\n  } else {\n    p._insertElement(token, NS.SVG);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction genericStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n} //OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\n\n\nfunction startTagInBody(p, token) {\n  const tn = token.tagName;\n\n  switch (tn.length) {\n    case 1:\n      if (tn === $.I || tn === $.S || tn === $.B || tn === $.U) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.P) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.A) {\n        aStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 2:\n      if (tn === $.DL || tn === $.OL || tn === $.UL) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        numberedHeaderStartTagInBody(p, token);\n      } else if (tn === $.LI || tn === $.DD || tn === $.DT) {\n        listItemStartTagInBody(p, token);\n      } else if (tn === $.EM || tn === $.TT) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.BR) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.HR) {\n        hrStartTagInBody(p, token);\n      } else if (tn === $.RB) {\n        rbStartTagInBody(p, token);\n      } else if (tn === $.RT || tn === $.RP) {\n        rtStartTagInBody(p, token);\n      } else if (tn !== $.TH && tn !== $.TD && tn !== $.TR) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.DIV || tn === $.DIR || tn === $.NAV) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.PRE) {\n        preStartTagInBody(p, token);\n      } else if (tn === $.BIG) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.IMG || tn === $.WBR) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.XMP) {\n        xmpStartTagInBody(p, token);\n      } else if (tn === $.SVG) {\n        svgStartTagInBody(p, token);\n      } else if (tn === $.RTC) {\n        rbStartTagInBody(p, token);\n      } else if (tn !== $.COL) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.HTML) {\n        htmlStartTagInBody(p, token);\n      } else if (tn === $.BASE || tn === $.LINK || tn === $.META) {\n        startTagInHead(p, token);\n      } else if (tn === $.BODY) {\n        bodyStartTagInBody(p, token);\n      } else if (tn === $.MAIN || tn === $.MENU) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.FORM) {\n        formStartTagInBody(p, token);\n      } else if (tn === $.CODE || tn === $.FONT) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.NOBR) {\n        nobrStartTagInBody(p, token);\n      } else if (tn === $.AREA) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.MATH) {\n        mathStartTagInBody(p, token);\n      } else if (tn === $.MENU) {\n        menuStartTagInBody(p, token);\n      } else if (tn !== $.HEAD) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.STYLE || tn === $.TITLE) {\n        startTagInHead(p, token);\n      } else if (tn === $.ASIDE) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.SMALL) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.TABLE) {\n        tableStartTagInBody(p, token);\n      } else if (tn === $.EMBED) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.INPUT) {\n        inputStartTagInBody(p, token);\n      } else if (tn === $.PARAM || tn === $.TRACK) {\n        paramStartTagInBody(p, token);\n      } else if (tn === $.IMAGE) {\n        imageStartTagInBody(p, token);\n      } else if (tn !== $.FRAME && tn !== $.TBODY && tn !== $.TFOOT && tn !== $.THEAD) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.SCRIPT) {\n        startTagInHead(p, token);\n      } else if (tn === $.CENTER || tn === $.FIGURE || tn === $.FOOTER || tn === $.HEADER || tn === $.HGROUP || tn === $.DIALOG) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.BUTTON) {\n        buttonStartTagInBody(p, token);\n      } else if (tn === $.STRIKE || tn === $.STRONG) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.APPLET || tn === $.OBJECT) {\n        appletStartTagInBody(p, token);\n      } else if (tn === $.KEYGEN) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.SOURCE) {\n        paramStartTagInBody(p, token);\n      } else if (tn === $.IFRAME) {\n        iframeStartTagInBody(p, token);\n      } else if (tn === $.SELECT) {\n        selectStartTagInBody(p, token);\n      } else if (tn === $.OPTION) {\n        optgroupStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.BGSOUND) {\n        startTagInHead(p, token);\n      } else if (tn === $.DETAILS || tn === $.ADDRESS || tn === $.ARTICLE || tn === $.SECTION || tn === $.SUMMARY) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.LISTING) {\n        preStartTagInBody(p, token);\n      } else if (tn === $.MARQUEE) {\n        appletStartTagInBody(p, token);\n      } else if (tn === $.NOEMBED) {\n        noembedStartTagInBody(p, token);\n      } else if (tn !== $.CAPTION) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.BASEFONT) {\n        startTagInHead(p, token);\n      } else if (tn === $.FRAMESET) {\n        framesetStartTagInBody(p, token);\n      } else if (tn === $.FIELDSET) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.TEXTAREA) {\n        textareaStartTagInBody(p, token);\n      } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n      } else if (tn === $.NOSCRIPT) {\n        if (p.options.scriptingEnabled) {\n          noembedStartTagInBody(p, token);\n        } else {\n          genericStartTagInBody(p, token);\n        }\n      } else if (tn === $.OPTGROUP) {\n        optgroupStartTagInBody(p, token);\n      } else if (tn !== $.COLGROUP) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 9:\n      if (tn === $.PLAINTEXT) {\n        plaintextStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 10:\n      if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n        addressStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    default:\n      genericStartTagInBody(p, token);\n  }\n}\n\nfunction bodyEndTagInBody(p) {\n  if (p.openElements.hasInScope($.BODY)) {\n    p.insertionMode = AFTER_BODY_MODE;\n  }\n}\n\nfunction htmlEndTagInBody(p, token) {\n  if (p.openElements.hasInScope($.BODY)) {\n    p.insertionMode = AFTER_BODY_MODE;\n\n    p._processToken(token);\n  }\n}\n\nfunction addressEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\n\nfunction formEndTagInBody(p) {\n  const inTemplate = p.openElements.tmplCount > 0;\n  const formElement = p.formElement;\n\n  if (!inTemplate) {\n    p.formElement = null;\n  }\n\n  if ((formElement || inTemplate) && p.openElements.hasInScope($.FORM)) {\n    p.openElements.generateImpliedEndTags();\n\n    if (inTemplate) {\n      p.openElements.popUntilTagNamePopped($.FORM);\n    } else {\n      p.openElements.remove(formElement);\n    }\n  }\n}\n\nfunction pEndTagInBody(p) {\n  if (!p.openElements.hasInButtonScope($.P)) {\n    p._insertFakeElement($.P);\n  }\n\n  p._closePElement();\n}\n\nfunction liEndTagInBody(p) {\n  if (p.openElements.hasInListItemScope($.LI)) {\n    p.openElements.generateImpliedEndTagsWithExclusion($.LI);\n    p.openElements.popUntilTagNamePopped($.LI);\n  }\n}\n\nfunction ddEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTagsWithExclusion(tn);\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\n\nfunction numberedHeaderEndTagInBody(p) {\n  if (p.openElements.hasNumberedHeaderInScope()) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilNumberedHeaderPopped();\n  }\n}\n\nfunction appletEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n    p.activeFormattingElements.clearToLastMarker();\n  }\n}\n\nfunction brEndTagInBody(p) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertFakeElement($.BR);\n\n  p.openElements.pop();\n  p.framesetOk = false;\n}\n\nfunction genericEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  for (let i = p.openElements.stackTop; i > 0; i--) {\n    const element = p.openElements.items[i];\n\n    if (p.treeAdapter.getTagName(element) === tn) {\n      p.openElements.generateImpliedEndTagsWithExclusion(tn);\n      p.openElements.popUntilElementPopped(element);\n      break;\n    }\n\n    if (p._isSpecialElement(element)) {\n      break;\n    }\n  }\n} //OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\n\n\nfunction endTagInBody(p, token) {\n  const tn = token.tagName;\n\n  switch (tn.length) {\n    case 1:\n      if (tn === $.A || tn === $.B || tn === $.I || tn === $.S || tn === $.U) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.P) {\n        pEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 2:\n      if (tn === $.DL || tn === $.UL || tn === $.OL) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.LI) {\n        liEndTagInBody(p, token);\n      } else if (tn === $.DD || tn === $.DT) {\n        ddEndTagInBody(p, token);\n      } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        numberedHeaderEndTagInBody(p, token);\n      } else if (tn === $.BR) {\n        brEndTagInBody(p, token);\n      } else if (tn === $.EM || tn === $.TT) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.BIG) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.DIR || tn === $.DIV || tn === $.NAV || tn === $.PRE) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.BODY) {\n        bodyEndTagInBody(p, token);\n      } else if (tn === $.HTML) {\n        htmlEndTagInBody(p, token);\n      } else if (tn === $.FORM) {\n        formEndTagInBody(p, token);\n      } else if (tn === $.CODE || tn === $.FONT || tn === $.NOBR) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.MAIN || tn === $.MENU) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.ASIDE) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.SMALL) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.CENTER || tn === $.FIGURE || tn === $.FOOTER || tn === $.HEADER || tn === $.HGROUP || tn === $.DIALOG) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.APPLET || tn === $.OBJECT) {\n        appletEndTagInBody(p, token);\n      } else if (tn === $.STRIKE || tn === $.STRONG) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.ADDRESS || tn === $.ARTICLE || tn === $.DETAILS || tn === $.SECTION || tn === $.SUMMARY || tn === $.LISTING) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.MARQUEE) {\n        appletEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.FIELDSET) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 10:\n      if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    default:\n      genericEndTagInBody(p, token);\n  }\n}\n\nfunction eofInBody(p, token) {\n  if (p.tmplInsertionModeStackTop > -1) {\n    eofInTemplate(p, token);\n  } else {\n    p.stopped = true;\n  }\n} // The \"text\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction endTagInText(p, token) {\n  if (token.tagName === $.SCRIPT) {\n    p.pendingScript = p.openElements.current;\n  }\n\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n}\n\nfunction eofInText(p, token) {\n  p._err(ERR.eofInElementThatCanContainOnlyText);\n\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n\n  p._processToken(token);\n} // The \"in table\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction characterInTable(p, token) {\n  const curTn = p.openElements.currentTagName;\n\n  if (curTn === $.TABLE || curTn === $.TBODY || curTn === $.TFOOT || curTn === $.THEAD || curTn === $.TR) {\n    p.pendingCharacterTokens = [];\n    p.hasNonWhitespacePendingCharacterToken = false;\n    p.originalInsertionMode = p.insertionMode;\n    p.insertionMode = IN_TABLE_TEXT_MODE;\n\n    p._processToken(token);\n  } else {\n    tokenInTable(p, token);\n  }\n}\n\nfunction captionStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p.activeFormattingElements.insertMarker();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_CAPTION_MODE;\n}\n\nfunction colgroupStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_COLUMN_GROUP_MODE;\n}\n\nfunction colStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertFakeElement($.COLGROUP);\n\n  p.insertionMode = IN_COLUMN_GROUP_MODE;\n\n  p._processToken(token);\n}\n\nfunction tbodyStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_TABLE_BODY_MODE;\n}\n\nfunction tdStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertFakeElement($.TBODY);\n\n  p.insertionMode = IN_TABLE_BODY_MODE;\n\n  p._processToken(token);\n}\n\nfunction tableStartTagInTable(p, token) {\n  if (p.openElements.hasInTableScope($.TABLE)) {\n    p.openElements.popUntilTagNamePopped($.TABLE);\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  }\n}\n\nfunction inputStartTagInTable(p, token) {\n  const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n  if (inputType && inputType.toLowerCase() === HIDDEN_INPUT_TYPE) {\n    p._appendElement(token, NS.HTML);\n  } else {\n    tokenInTable(p, token);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction formStartTagInTable(p, token) {\n  if (!p.formElement && p.openElements.tmplCount === 0) {\n    p._insertElement(token, NS.HTML);\n\n    p.formElement = p.openElements.current;\n    p.openElements.pop();\n  }\n}\n\nfunction startTagInTable(p, token) {\n  const tn = token.tagName;\n\n  switch (tn.length) {\n    case 2:\n      if (tn === $.TD || tn === $.TH || tn === $.TR) {\n        tdStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.COL) {\n        colStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.FORM) {\n        formStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.TABLE) {\n        tableStartTagInTable(p, token);\n      } else if (tn === $.STYLE) {\n        startTagInHead(p, token);\n      } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        tbodyStartTagInTable(p, token);\n      } else if (tn === $.INPUT) {\n        inputStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.SCRIPT) {\n        startTagInHead(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.CAPTION) {\n        captionStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.COLGROUP) {\n        colgroupStartTagInTable(p, token);\n      } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    default:\n      tokenInTable(p, token);\n  }\n}\n\nfunction endTagInTable(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.TABLE)) {\n      p.openElements.popUntilTagNamePopped($.TABLE);\n\n      p._resetInsertionMode();\n    }\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML && tn !== $.TBODY && tn !== $.TD && tn !== $.TFOOT && tn !== $.TH && tn !== $.THEAD && tn !== $.TR) {\n    tokenInTable(p, token);\n  }\n}\n\nfunction tokenInTable(p, token) {\n  const savedFosterParentingState = p.fosterParentingEnabled;\n  p.fosterParentingEnabled = true;\n\n  p._processTokenInBodyMode(token);\n\n  p.fosterParentingEnabled = savedFosterParentingState;\n} // The \"in table text\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction whitespaceCharacterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n}\n\nfunction characterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n  p.hasNonWhitespacePendingCharacterToken = true;\n}\n\nfunction tokenInTableText(p, token) {\n  let i = 0;\n\n  if (p.hasNonWhitespacePendingCharacterToken) {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      tokenInTable(p, p.pendingCharacterTokens[i]);\n    }\n  } else {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      p._insertCharacters(p.pendingCharacterTokens[i]);\n    }\n  }\n\n  p.insertionMode = p.originalInsertionMode;\n\n  p._processToken(token);\n} // The \"in caption\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInCaption(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TD || tn === $.TFOOT || tn === $.TH || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.CAPTION)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped($.CAPTION);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\n\nfunction endTagInCaption(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.CAPTION)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped($.CAPTION);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_TABLE_MODE;\n\n      if (tn === $.TABLE) {\n        p._processToken(token);\n      }\n    }\n  } else if (tn !== $.BODY && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML && tn !== $.TBODY && tn !== $.TD && tn !== $.TFOOT && tn !== $.TH && tn !== $.THEAD && tn !== $.TR) {\n    endTagInBody(p, token);\n  }\n} // The \"in column group\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInColumnGroup(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.COL) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.TEMPLATE) {\n    startTagInHead(p, token);\n  } else {\n    tokenInColumnGroup(p, token);\n  }\n}\n\nfunction endTagInColumnGroup(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.COLGROUP) {\n    if (p.openElements.currentTagName === $.COLGROUP) {\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n    }\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else if (tn !== $.COL) {\n    tokenInColumnGroup(p, token);\n  }\n}\n\nfunction tokenInColumnGroup(p, token) {\n  if (p.openElements.currentTagName === $.COLGROUP) {\n    p.openElements.pop();\n    p.insertionMode = IN_TABLE_MODE;\n\n    p._processToken(token);\n  }\n} // The \"in table body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInTableBody(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TR) {\n    p.openElements.clearBackToTableBodyContext();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_ROW_MODE;\n  } else if (tn === $.TH || tn === $.TD) {\n    p.openElements.clearBackToTableBodyContext();\n\n    p._insertFakeElement($.TR);\n\n    p.insertionMode = IN_ROW_MODE;\n\n    p._processToken(token);\n  } else if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasTableBodyContextInTableScope()) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInTable(p, token);\n  }\n}\n\nfunction endTagInTableBody(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n    }\n  } else if (tn === $.TABLE) {\n    if (p.openElements.hasTableBodyContextInTableScope()) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP || tn !== $.HTML && tn !== $.TD && tn !== $.TH && tn !== $.TR) {\n    endTagInTable(p, token);\n  }\n} // The \"in row\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInRow(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TH || tn === $.TD) {\n    p.openElements.clearBackToTableRowContext();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_CELL_MODE;\n    p.activeFormattingElements.insertMarker();\n  } else if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInTable(p, token);\n  }\n}\n\nfunction endTagInRow(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n    }\n  } else if (tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasInTableScope(tn) || p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP || tn !== $.HTML && tn !== $.TD && tn !== $.TH) {\n    endTagInTable(p, token);\n  }\n} // The \"in cell\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInCell(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TD || tn === $.TFOOT || tn === $.TH || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TD) || p.openElements.hasInTableScope($.TH)) {\n      p._closeTableCell();\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\n\nfunction endTagInCell(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TD || tn === $.TH) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped(tn);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_ROW_MODE;\n    }\n  } else if (tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p._closeTableCell();\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML) {\n    endTagInBody(p, token);\n  }\n} // The \"in select\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInSelect(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.OPTION) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.OPTGROUP) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n\n    if (p.openElements.currentTagName === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.INPUT || tn === $.KEYGEN || tn === $.TEXTAREA || tn === $.SELECT) {\n    if (p.openElements.hasInSelectScope($.SELECT)) {\n      p.openElements.popUntilTagNamePopped($.SELECT);\n\n      p._resetInsertionMode();\n\n      if (tn !== $.SELECT) {\n        p._processToken(token);\n      }\n    }\n  } else if (tn === $.SCRIPT || tn === $.TEMPLATE) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagInSelect(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.OPTGROUP) {\n    const prevOpenElement = p.openElements.items[p.openElements.stackTop - 1];\n    const prevOpenElementTn = prevOpenElement && p.treeAdapter.getTagName(prevOpenElement);\n\n    if (p.openElements.currentTagName === $.OPTION && prevOpenElementTn === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n\n    if (p.openElements.currentTagName === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n  } else if (tn === $.OPTION) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n  } else if (tn === $.SELECT && p.openElements.hasInSelectScope($.SELECT)) {\n    p.openElements.popUntilTagNamePopped($.SELECT);\n\n    p._resetInsertionMode();\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  }\n} //12.2.5.4.17 The \"in select in table\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInSelectInTable(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR || tn === $.TD || tn === $.TH) {\n    p.openElements.popUntilTagNamePopped($.SELECT);\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  } else {\n    startTagInSelect(p, token);\n  }\n}\n\nfunction endTagInSelectInTable(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR || tn === $.TD || tn === $.TH) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.popUntilTagNamePopped($.SELECT);\n\n      p._resetInsertionMode();\n\n      p._processToken(token);\n    }\n  } else {\n    endTagInSelect(p, token);\n  }\n} // The \"in template\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInTemplate(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.SCRIPT || tn === $.STYLE || tn === $.TEMPLATE || tn === $.TITLE) {\n    startTagInHead(p, token);\n  } else {\n    const newInsertionMode = TEMPLATE_INSERTION_MODE_SWITCH_MAP[tn] || IN_BODY_MODE;\n\n    p._popTmplInsertionMode();\n\n    p._pushTmplInsertionMode(newInsertionMode);\n\n    p.insertionMode = newInsertionMode;\n\n    p._processToken(token);\n  }\n}\n\nfunction endTagInTemplate(p, token) {\n  if (token.tagName === $.TEMPLATE) {\n    endTagInHead(p, token);\n  }\n}\n\nfunction eofInTemplate(p, token) {\n  if (p.openElements.tmplCount > 0) {\n    p.openElements.popUntilTagNamePopped($.TEMPLATE);\n    p.activeFormattingElements.clearToLastMarker();\n\n    p._popTmplInsertionMode();\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  } else {\n    p.stopped = true;\n  }\n} // The \"after body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\n\nfunction endTagAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    if (!p.fragmentContext) {\n      p.insertionMode = AFTER_AFTER_BODY_MODE;\n    }\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\n\nfunction tokenAfterBody(p, token) {\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"in frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInFrameset(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.FRAMESET) {\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.FRAME) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagInFrameset(p, token) {\n  if (token.tagName === $.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n    p.openElements.pop();\n\n    if (!p.fragmentContext && p.openElements.currentTagName !== $.FRAMESET) {\n      p.insertionMode = AFTER_FRAMESET_MODE;\n    }\n  }\n} // The \"after frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterFrameset(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagAfterFrameset(p, token) {\n  if (token.tagName === $.HTML) {\n    p.insertionMode = AFTER_AFTER_FRAMESET_MODE;\n  }\n} // The \"after after body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterAfterBody(p, token);\n  }\n}\n\nfunction tokenAfterAfterBody(p, token) {\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterAfterFrameset(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n} // The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\n\n\nfunction nullCharacterInForeignContent(p, token) {\n  token.chars = unicode.REPLACEMENT_CHARACTER;\n\n  p._insertCharacters(token);\n}\n\nfunction characterInForeignContent(p, token) {\n  p._insertCharacters(token);\n\n  p.framesetOk = false;\n}\n\nfunction startTagInForeignContent(p, token) {\n  if (foreignContent.causesExit(token) && !p.fragmentContext) {\n    while (p.treeAdapter.getNamespaceURI(p.openElements.current) !== NS.HTML && !p._isIntegrationPoint(p.openElements.current)) {\n      p.openElements.pop();\n    }\n\n    p._processToken(token);\n  } else {\n    const current = p._getAdjustedCurrentElement();\n\n    const currentNs = p.treeAdapter.getNamespaceURI(current);\n\n    if (currentNs === NS.MATHML) {\n      foreignContent.adjustTokenMathMLAttrs(token);\n    } else if (currentNs === NS.SVG) {\n      foreignContent.adjustTokenSVGTagName(token);\n      foreignContent.adjustTokenSVGAttrs(token);\n    }\n\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n      p._appendElement(token, currentNs);\n    } else {\n      p._insertElement(token, currentNs);\n    }\n\n    token.ackSelfClosing = true;\n  }\n}\n\nfunction endTagInForeignContent(p, token) {\n  for (let i = p.openElements.stackTop; i > 0; i--) {\n    const element = p.openElements.items[i];\n\n    if (p.treeAdapter.getNamespaceURI(element) === NS.HTML) {\n      p._processToken(token);\n\n      break;\n    }\n\n    if (p.treeAdapter.getTagName(element).toLowerCase() === token.tagName) {\n      p.openElements.popUntilElementPopped(element);\n      break;\n    }\n  }\n}","map":{"version":3,"sources":["/Users/leon/lib-test/liraz-test/node_modules/parse5/lib/parser/index.js"],"names":["Tokenizer","require","OpenElementStack","FormattingElementList","LocationInfoParserMixin","ErrorReportingParserMixin","Mixin","defaultTreeAdapter","mergeOptions","doctype","foreignContent","ERR","unicode","HTML","$","TAG_NAMES","NS","NAMESPACES","ATTRS","DEFAULT_OPTIONS","scriptingEnabled","sourceCodeLocationInfo","onParseError","treeAdapter","HIDDEN_INPUT_TYPE","AA_OUTER_LOOP_ITER","AA_INNER_LOOP_ITER","INITIAL_MODE","BEFORE_HTML_MODE","BEFORE_HEAD_MODE","IN_HEAD_MODE","IN_HEAD_NO_SCRIPT_MODE","AFTER_HEAD_MODE","IN_BODY_MODE","TEXT_MODE","IN_TABLE_MODE","IN_TABLE_TEXT_MODE","IN_CAPTION_MODE","IN_COLUMN_GROUP_MODE","IN_TABLE_BODY_MODE","IN_ROW_MODE","IN_CELL_MODE","IN_SELECT_MODE","IN_SELECT_IN_TABLE_MODE","IN_TEMPLATE_MODE","AFTER_BODY_MODE","IN_FRAMESET_MODE","AFTER_FRAMESET_MODE","AFTER_AFTER_BODY_MODE","AFTER_AFTER_FRAMESET_MODE","INSERTION_MODE_RESET_MAP","TR","TBODY","THEAD","TFOOT","CAPTION","COLGROUP","TABLE","BODY","FRAMESET","TEMPLATE_INSERTION_MODE_SWITCH_MAP","COL","TD","TH","TOKEN_HANDLERS","CHARACTER_TOKEN","tokenInInitialMode","NULL_CHARACTER_TOKEN","WHITESPACE_CHARACTER_TOKEN","ignoreToken","COMMENT_TOKEN","appendComment","DOCTYPE_TOKEN","doctypeInInitialMode","START_TAG_TOKEN","END_TAG_TOKEN","EOF_TOKEN","tokenBeforeHtml","startTagBeforeHtml","endTagBeforeHtml","tokenBeforeHead","misplacedDoctype","startTagBeforeHead","endTagBeforeHead","tokenInHead","insertCharacters","startTagInHead","endTagInHead","tokenInHeadNoScript","startTagInHeadNoScript","endTagInHeadNoScript","tokenAfterHead","startTagAfterHead","endTagAfterHead","characterInBody","whitespaceCharacterInBody","startTagInBody","endTagInBody","eofInBody","endTagInText","eofInText","characterInTable","startTagInTable","endTagInTable","characterInTableText","whitespaceCharacterInTableText","tokenInTableText","startTagInCaption","endTagInCaption","tokenInColumnGroup","startTagInColumnGroup","endTagInColumnGroup","startTagInTableBody","endTagInTableBody","startTagInRow","endTagInRow","startTagInCell","endTagInCell","startTagInSelect","endTagInSelect","startTagInSelectInTable","endTagInSelectInTable","startTagInTemplate","endTagInTemplate","eofInTemplate","tokenAfterBody","appendCommentToRootHtmlElement","startTagAfterBody","endTagAfterBody","stopParsing","startTagInFrameset","endTagInFrameset","startTagAfterFrameset","endTagAfterFrameset","tokenAfterAfterBody","appendCommentToDocument","startTagAfterAfterBody","startTagAfterAfterFrameset","Parser","constructor","options","pendingScript","install","parse","html","document","createDocument","_bootstrap","tokenizer","write","_runParsingLoop","parseFragment","fragmentContext","createElement","TEMPLATE","documentMock","getTagName","_pushTmplInsertionMode","_initTokenizerForFragmentParsing","_insertFakeRootElement","_resetInsertionMode","_findFormInFragmentContext","rootElement","getFirstChild","fragment","createDocumentFragment","_adoptNodes","stopped","insertionMode","originalInsertionMode","headElement","formElement","openElements","activeFormattingElements","tmplInsertionModeStack","tmplInsertionModeStackTop","currentTmplInsertionMode","pendingCharacterTokens","hasNonWhitespacePendingCharacterToken","framesetOk","skipNextNewLine","fosterParentingEnabled","_err","scriptHandler","_setupTokenizerCDATAMode","token","getNextToken","type","HIBERNATION_TOKEN","chars","length","substr","_processInputToken","runParsingLoopForCurrentChunk","writeCallback","script","current","_getAdjustedCurrentElement","allowCDATA","getNamespaceURI","_isIntegrationPoint","_switchToTextParsing","currentToken","nextTokenizerState","_insertElement","state","switchToPlaintextParsing","MODE","PLAINTEXT","stackTop","node","FORM","getParentNode","tn","TITLE","TEXTAREA","RCDATA","STYLE","XMP","IFRAME","NOEMBED","NOFRAMES","NOSCRIPT","RAWTEXT","SCRIPT","SCRIPT_DATA","_setDocumentType","name","publicId","systemId","setDocumentType","_attachElementToTree","element","_shouldFosterParentOnInsertion","_fosterParentElement","parent","currentTmplContent","appendChild","_appendElement","namespaceURI","tagName","attrs","push","_insertFakeElement","_insertTemplate","tmpl","content","setTemplateContent","_appendCommentNode","commentNode","createCommentNode","data","_insertCharacters","_fosterParentText","insertText","donor","recipient","child","detachNode","_shouldProcessTokenInForeignContent","ns","ANNOTATION_XML","MATHML","SVG","isCharacterToken","isMathMLTextStartTag","MGLYPH","MALIGNMARK","_processToken","_processTokenInBodyMode","_processTokenInForeignContent","characterInForeignContent","nullCharacterInForeignContent","startTagInForeignContent","endTagInForeignContent","selfClosing","ackSelfClosing","nonVoidHtmlElementStartTagWithTrailingSolidus","foreignNS","getAttrList","isIntegrationPoint","_reconstructActiveFormattingElements","listLength","unopenIdx","entry","entries","MARKER_ENTRY","contains","i","_closeTableCell","generateImpliedEndTags","popUntilTableCellPopped","clearToLastMarker","_closePElement","generateImpliedEndTagsWithExclusion","P","popUntilTagNamePopped","last","items","newInsertionMode","HEAD","SELECT","_resetInsertionModeForSelect","selectIdx","ancestor","mode","_popTmplInsertionMode","pop","_isElementCausesFosterParenting","_findFosterParentingLocation","location","beforeElement","openElement","getTemplateContent","insertBefore","insertTextBefore","_isSpecialElement","SPECIAL_ELEMENTS","module","exports","aaObtainFormattingElementEntry","p","formattingElementEntry","getElementEntryInScopeWithTagName","removeEntry","hasInScope","genericEndTagInBody","aaObtainFurthestBlock","furthestBlock","popUntilElementPopped","aaInnerLoop","formattingElement","lastElement","nextElement","getCommonAncestor","elementEntry","getElementEntry","counterOverflow","shouldRemoveFromOpenElements","remove","aaRecreateElementFromEntry","bookmark","newElement","replace","aaInsertLastNodeInCommonAncestor","commonAncestor","aaReplaceFormattingElement","insertElementAfterBookmark","insertAfter","callAdoptionAgency","forceQuirks","DOCUMENT_MODE","QUIRKS","getDocumentMode","isConforming","nonConformingDoctype","setDocumentMode","missingDoctype","beforeToken","BR","endTagWithoutMatchingOpenElement","BASE","BASEFONT","BGSOUND","LINK","META","insertMarker","misplacedStartTagForHeadElement","tmplCount","generateImpliedEndTagsThoroughly","currentTagName","closingOfElementWithOpenChildElements","nestedNoscriptInHead","errCode","openElementsLeftAfterEof","disallowedContentInNoscriptInHead","abandonedHeadElementChild","htmlStartTagInBody","adoptAttributes","bodyStartTagInBody","bodyElement","tryPeekProperlyNestedBodyElement","framesetStartTagInBody","popAllUpToHtmlElement","addressStartTagInBody","hasInButtonScope","numberedHeaderStartTagInBody","H1","H2","H3","H4","H5","H6","preStartTagInBody","formStartTagInBody","inTemplate","listItemStartTagInBody","elementTn","closeTn","LI","DD","DT","ADDRESS","DIV","plaintextStartTagInBody","buttonStartTagInBody","BUTTON","aStartTagInBody","activeElementEntry","A","pushElement","bStartTagInBody","nobrStartTagInBody","NOBR","appletStartTagInBody","tableStartTagInBody","areaStartTagInBody","inputStartTagInBody","inputType","getTokenAttr","TYPE","toLowerCase","paramStartTagInBody","hrStartTagInBody","imageStartTagInBody","IMG","textareaStartTagInBody","xmpStartTagInBody","iframeStartTagInBody","noembedStartTagInBody","selectStartTagInBody","optgroupStartTagInBody","OPTION","rbStartTagInBody","RUBY","rtStartTagInBody","RTC","menuStartTagInBody","mathStartTagInBody","adjustTokenMathMLAttrs","adjustTokenXMLAttrs","svgStartTagInBody","adjustTokenSVGAttrs","genericStartTagInBody","I","S","B","U","DL","OL","UL","EM","TT","HR","RB","RT","RP","DIR","NAV","PRE","BIG","WBR","MAIN","MENU","CODE","FONT","AREA","MATH","ASIDE","SMALL","EMBED","INPUT","PARAM","TRACK","IMAGE","FRAME","CENTER","FIGURE","FOOTER","HEADER","HGROUP","DIALOG","STRIKE","STRONG","APPLET","OBJECT","KEYGEN","SOURCE","DETAILS","ARTICLE","SECTION","SUMMARY","LISTING","MARQUEE","FIELDSET","OPTGROUP","BLOCKQUOTE","FIGCAPTION","bodyEndTagInBody","htmlEndTagInBody","addressEndTagInBody","formEndTagInBody","pEndTagInBody","liEndTagInBody","hasInListItemScope","ddEndTagInBody","numberedHeaderEndTagInBody","hasNumberedHeaderInScope","popUntilNumberedHeaderPopped","appletEndTagInBody","brEndTagInBody","eofInElementThatCanContainOnlyText","curTn","tokenInTable","captionStartTagInTable","clearBackToTableContext","colgroupStartTagInTable","colStartTagInTable","tbodyStartTagInTable","tdStartTagInTable","tableStartTagInTable","hasInTableScope","inputStartTagInTable","formStartTagInTable","savedFosterParentingState","clearBackToTableBodyContext","hasTableBodyContextInTableScope","clearBackToTableRowContext","hasInSelectScope","prevOpenElement","prevOpenElementTn","isRootHtmlElementCurrent","REPLACEMENT_CHARACTER","causesExit","currentNs","adjustTokenSVGTagName"],"mappings":"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","sourcesContent":["'use strict';\n\nconst Tokenizer = require('../tokenizer');\nconst OpenElementStack = require('./open-element-stack');\nconst FormattingElementList = require('./formatting-element-list');\nconst LocationInfoParserMixin = require('../extensions/location-info/parser-mixin');\nconst ErrorReportingParserMixin = require('../extensions/error-reporting/parser-mixin');\nconst Mixin = require('../utils/mixin');\nconst defaultTreeAdapter = require('../tree-adapters/default');\nconst mergeOptions = require('../utils/merge-options');\nconst doctype = require('../common/doctype');\nconst foreignContent = require('../common/foreign-content');\nconst ERR = require('../common/error-codes');\nconst unicode = require('../common/unicode');\nconst HTML = require('../common/html');\n\n//Aliases\nconst $ = HTML.TAG_NAMES;\nconst NS = HTML.NAMESPACES;\nconst ATTRS = HTML.ATTRS;\n\nconst DEFAULT_OPTIONS = {\n    scriptingEnabled: true,\n    sourceCodeLocationInfo: false,\n    onParseError: null,\n    treeAdapter: defaultTreeAdapter\n};\n\n//Misc constants\nconst HIDDEN_INPUT_TYPE = 'hidden';\n\n//Adoption agency loops iteration count\nconst AA_OUTER_LOOP_ITER = 8;\nconst AA_INNER_LOOP_ITER = 3;\n\n//Insertion modes\nconst INITIAL_MODE = 'INITIAL_MODE';\nconst BEFORE_HTML_MODE = 'BEFORE_HTML_MODE';\nconst BEFORE_HEAD_MODE = 'BEFORE_HEAD_MODE';\nconst IN_HEAD_MODE = 'IN_HEAD_MODE';\nconst IN_HEAD_NO_SCRIPT_MODE = 'IN_HEAD_NO_SCRIPT_MODE';\nconst AFTER_HEAD_MODE = 'AFTER_HEAD_MODE';\nconst IN_BODY_MODE = 'IN_BODY_MODE';\nconst TEXT_MODE = 'TEXT_MODE';\nconst IN_TABLE_MODE = 'IN_TABLE_MODE';\nconst IN_TABLE_TEXT_MODE = 'IN_TABLE_TEXT_MODE';\nconst IN_CAPTION_MODE = 'IN_CAPTION_MODE';\nconst IN_COLUMN_GROUP_MODE = 'IN_COLUMN_GROUP_MODE';\nconst IN_TABLE_BODY_MODE = 'IN_TABLE_BODY_MODE';\nconst IN_ROW_MODE = 'IN_ROW_MODE';\nconst IN_CELL_MODE = 'IN_CELL_MODE';\nconst IN_SELECT_MODE = 'IN_SELECT_MODE';\nconst IN_SELECT_IN_TABLE_MODE = 'IN_SELECT_IN_TABLE_MODE';\nconst IN_TEMPLATE_MODE = 'IN_TEMPLATE_MODE';\nconst AFTER_BODY_MODE = 'AFTER_BODY_MODE';\nconst IN_FRAMESET_MODE = 'IN_FRAMESET_MODE';\nconst AFTER_FRAMESET_MODE = 'AFTER_FRAMESET_MODE';\nconst AFTER_AFTER_BODY_MODE = 'AFTER_AFTER_BODY_MODE';\nconst AFTER_AFTER_FRAMESET_MODE = 'AFTER_AFTER_FRAMESET_MODE';\n\n//Insertion mode reset map\nconst INSERTION_MODE_RESET_MAP = {\n    [$.TR]: IN_ROW_MODE,\n    [$.TBODY]: IN_TABLE_BODY_MODE,\n    [$.THEAD]: IN_TABLE_BODY_MODE,\n    [$.TFOOT]: IN_TABLE_BODY_MODE,\n    [$.CAPTION]: IN_CAPTION_MODE,\n    [$.COLGROUP]: IN_COLUMN_GROUP_MODE,\n    [$.TABLE]: IN_TABLE_MODE,\n    [$.BODY]: IN_BODY_MODE,\n    [$.FRAMESET]: IN_FRAMESET_MODE\n};\n\n//Template insertion mode switch map\nconst TEMPLATE_INSERTION_MODE_SWITCH_MAP = {\n    [$.CAPTION]: IN_TABLE_MODE,\n    [$.COLGROUP]: IN_TABLE_MODE,\n    [$.TBODY]: IN_TABLE_MODE,\n    [$.TFOOT]: IN_TABLE_MODE,\n    [$.THEAD]: IN_TABLE_MODE,\n    [$.COL]: IN_COLUMN_GROUP_MODE,\n    [$.TR]: IN_TABLE_BODY_MODE,\n    [$.TD]: IN_ROW_MODE,\n    [$.TH]: IN_ROW_MODE\n};\n\n//Token handlers map for insertion modes\nconst TOKEN_HANDLERS = {\n    [INITIAL_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInInitialMode,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInInitialMode,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: doctypeInInitialMode,\n        [Tokenizer.START_TAG_TOKEN]: tokenInInitialMode,\n        [Tokenizer.END_TAG_TOKEN]: tokenInInitialMode,\n        [Tokenizer.EOF_TOKEN]: tokenInInitialMode\n    },\n    [BEFORE_HTML_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHtml,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHtml,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagBeforeHtml,\n        [Tokenizer.END_TAG_TOKEN]: endTagBeforeHtml,\n        [Tokenizer.EOF_TOKEN]: tokenBeforeHtml\n    },\n    [BEFORE_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagBeforeHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagBeforeHead,\n        [Tokenizer.EOF_TOKEN]: tokenBeforeHead\n    },\n    [IN_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagInHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagInHead,\n        [Tokenizer.EOF_TOKEN]: tokenInHead\n    },\n    [IN_HEAD_NO_SCRIPT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInHeadNoScript,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHeadNoScript,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagInHeadNoScript,\n        [Tokenizer.END_TAG_TOKEN]: endTagInHeadNoScript,\n        [Tokenizer.EOF_TOKEN]: tokenInHeadNoScript\n    },\n    [AFTER_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterHead,\n        [Tokenizer.EOF_TOKEN]: tokenAfterHead\n    },\n    [IN_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagInBody,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [TEXT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: ignoreToken,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: ignoreToken,\n        [Tokenizer.END_TAG_TOKEN]: endTagInText,\n        [Tokenizer.EOF_TOKEN]: eofInText\n    },\n    [IN_TABLE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTable,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTable,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TABLE_TEXT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTableText,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInTableText,\n        [Tokenizer.COMMENT_TOKEN]: tokenInTableText,\n        [Tokenizer.DOCTYPE_TOKEN]: tokenInTableText,\n        [Tokenizer.START_TAG_TOKEN]: tokenInTableText,\n        [Tokenizer.END_TAG_TOKEN]: tokenInTableText,\n        [Tokenizer.EOF_TOKEN]: tokenInTableText\n    },\n    [IN_CAPTION_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInCaption,\n        [Tokenizer.END_TAG_TOKEN]: endTagInCaption,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_COLUMN_GROUP_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInColumnGroup,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInColumnGroup,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInColumnGroup,\n        [Tokenizer.END_TAG_TOKEN]: endTagInColumnGroup,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TABLE_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTableBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTableBody,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_ROW_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInRow,\n        [Tokenizer.END_TAG_TOKEN]: endTagInRow,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_CELL_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInCell,\n        [Tokenizer.END_TAG_TOKEN]: endTagInCell,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_SELECT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInSelect,\n        [Tokenizer.END_TAG_TOKEN]: endTagInSelect,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_SELECT_IN_TABLE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInSelectInTable,\n        [Tokenizer.END_TAG_TOKEN]: endTagInSelectInTable,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TEMPLATE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTemplate,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTemplate,\n        [Tokenizer.EOF_TOKEN]: eofInTemplate\n    },\n    [AFTER_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterBody,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToRootHtmlElement,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterBody,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [IN_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInFrameset,\n        [Tokenizer.END_TAG_TOKEN]: endTagInFrameset,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterFrameset,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterFrameset,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_AFTER_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterBody,\n        [Tokenizer.END_TAG_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_AFTER_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterFrameset,\n        [Tokenizer.END_TAG_TOKEN]: ignoreToken,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    }\n};\n\n//Parser\nclass Parser {\n    constructor(options) {\n        this.options = mergeOptions(DEFAULT_OPTIONS, options);\n\n        this.treeAdapter = this.options.treeAdapter;\n        this.pendingScript = null;\n\n        if (this.options.sourceCodeLocationInfo) {\n            Mixin.install(this, LocationInfoParserMixin);\n        }\n\n        if (this.options.onParseError) {\n            Mixin.install(this, ErrorReportingParserMixin, { onParseError: this.options.onParseError });\n        }\n    }\n\n    // API\n    parse(html) {\n        const document = this.treeAdapter.createDocument();\n\n        this._bootstrap(document, null);\n        this.tokenizer.write(html, true);\n        this._runParsingLoop(null);\n\n        return document;\n    }\n\n    parseFragment(html, fragmentContext) {\n        //NOTE: use <template> element as a fragment context if context element was not provided,\n        //so we will parse in \"forgiving\" manner\n        if (!fragmentContext) {\n            fragmentContext = this.treeAdapter.createElement($.TEMPLATE, NS.HTML, []);\n        }\n\n        //NOTE: create fake element which will be used as 'document' for fragment parsing.\n        //This is important for jsdom there 'document' can't be recreated, therefore\n        //fragment parsing causes messing of the main `document`.\n        const documentMock = this.treeAdapter.createElement('documentmock', NS.HTML, []);\n\n        this._bootstrap(documentMock, fragmentContext);\n\n        if (this.treeAdapter.getTagName(fragmentContext) === $.TEMPLATE) {\n            this._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n        }\n\n        this._initTokenizerForFragmentParsing();\n        this._insertFakeRootElement();\n        this._resetInsertionMode();\n        this._findFormInFragmentContext();\n        this.tokenizer.write(html, true);\n        this._runParsingLoop(null);\n\n        const rootElement = this.treeAdapter.getFirstChild(documentMock);\n        const fragment = this.treeAdapter.createDocumentFragment();\n\n        this._adoptNodes(rootElement, fragment);\n\n        return fragment;\n    }\n\n    //Bootstrap parser\n    _bootstrap(document, fragmentContext) {\n        this.tokenizer = new Tokenizer(this.options);\n\n        this.stopped = false;\n\n        this.insertionMode = INITIAL_MODE;\n        this.originalInsertionMode = '';\n\n        this.document = document;\n        this.fragmentContext = fragmentContext;\n\n        this.headElement = null;\n        this.formElement = null;\n\n        this.openElements = new OpenElementStack(this.document, this.treeAdapter);\n        this.activeFormattingElements = new FormattingElementList(this.treeAdapter);\n\n        this.tmplInsertionModeStack = [];\n        this.tmplInsertionModeStackTop = -1;\n        this.currentTmplInsertionMode = null;\n\n        this.pendingCharacterTokens = [];\n        this.hasNonWhitespacePendingCharacterToken = false;\n\n        this.framesetOk = true;\n        this.skipNextNewLine = false;\n        this.fosterParentingEnabled = false;\n    }\n\n    //Errors\n    _err() {\n        // NOTE: err reporting is noop by default. Enabled by mixin.\n    }\n\n    //Parsing loop\n    _runParsingLoop(scriptHandler) {\n        while (!this.stopped) {\n            this._setupTokenizerCDATAMode();\n\n            const token = this.tokenizer.getNextToken();\n\n            if (token.type === Tokenizer.HIBERNATION_TOKEN) {\n                break;\n            }\n\n            if (this.skipNextNewLine) {\n                this.skipNextNewLine = false;\n\n                if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n                    if (token.chars.length === 1) {\n                        continue;\n                    }\n\n                    token.chars = token.chars.substr(1);\n                }\n            }\n\n            this._processInputToken(token);\n\n            if (scriptHandler && this.pendingScript) {\n                break;\n            }\n        }\n    }\n\n    runParsingLoopForCurrentChunk(writeCallback, scriptHandler) {\n        this._runParsingLoop(scriptHandler);\n\n        if (scriptHandler && this.pendingScript) {\n            const script = this.pendingScript;\n\n            this.pendingScript = null;\n\n            scriptHandler(script);\n\n            return;\n        }\n\n        if (writeCallback) {\n            writeCallback();\n        }\n    }\n\n    //Text parsing\n    _setupTokenizerCDATAMode() {\n        const current = this._getAdjustedCurrentElement();\n\n        this.tokenizer.allowCDATA =\n            current &&\n            current !== this.document &&\n            this.treeAdapter.getNamespaceURI(current) !== NS.HTML &&\n            !this._isIntegrationPoint(current);\n    }\n\n    _switchToTextParsing(currentToken, nextTokenizerState) {\n        this._insertElement(currentToken, NS.HTML);\n        this.tokenizer.state = nextTokenizerState;\n        this.originalInsertionMode = this.insertionMode;\n        this.insertionMode = TEXT_MODE;\n    }\n\n    switchToPlaintextParsing() {\n        this.insertionMode = TEXT_MODE;\n        this.originalInsertionMode = IN_BODY_MODE;\n        this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n    }\n\n    //Fragment parsing\n    _getAdjustedCurrentElement() {\n        return this.openElements.stackTop === 0 && this.fragmentContext\n            ? this.fragmentContext\n            : this.openElements.current;\n    }\n\n    _findFormInFragmentContext() {\n        let node = this.fragmentContext;\n\n        do {\n            if (this.treeAdapter.getTagName(node) === $.FORM) {\n                this.formElement = node;\n                break;\n            }\n\n            node = this.treeAdapter.getParentNode(node);\n        } while (node);\n    }\n\n    _initTokenizerForFragmentParsing() {\n        if (this.treeAdapter.getNamespaceURI(this.fragmentContext) === NS.HTML) {\n            const tn = this.treeAdapter.getTagName(this.fragmentContext);\n\n            if (tn === $.TITLE || tn === $.TEXTAREA) {\n                this.tokenizer.state = Tokenizer.MODE.RCDATA;\n            } else if (\n                tn === $.STYLE ||\n                tn === $.XMP ||\n                tn === $.IFRAME ||\n                tn === $.NOEMBED ||\n                tn === $.NOFRAMES ||\n                tn === $.NOSCRIPT\n            ) {\n                this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n            } else if (tn === $.SCRIPT) {\n                this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;\n            } else if (tn === $.PLAINTEXT) {\n                this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n            }\n        }\n    }\n\n    //Tree mutation\n    _setDocumentType(token) {\n        const name = token.name || '';\n        const publicId = token.publicId || '';\n        const systemId = token.systemId || '';\n\n        this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n    }\n\n    _attachElementToTree(element) {\n        if (this._shouldFosterParentOnInsertion()) {\n            this._fosterParentElement(element);\n        } else {\n            const parent = this.openElements.currentTmplContent || this.openElements.current;\n\n            this.treeAdapter.appendChild(parent, element);\n        }\n    }\n\n    _appendElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n        this._attachElementToTree(element);\n    }\n\n    _insertElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n        this._attachElementToTree(element);\n        this.openElements.push(element);\n    }\n\n    _insertFakeElement(tagName) {\n        const element = this.treeAdapter.createElement(tagName, NS.HTML, []);\n\n        this._attachElementToTree(element);\n        this.openElements.push(element);\n    }\n\n    _insertTemplate(token) {\n        const tmpl = this.treeAdapter.createElement(token.tagName, NS.HTML, token.attrs);\n        const content = this.treeAdapter.createDocumentFragment();\n\n        this.treeAdapter.setTemplateContent(tmpl, content);\n        this._attachElementToTree(tmpl);\n        this.openElements.push(tmpl);\n    }\n\n    _insertFakeRootElement() {\n        const element = this.treeAdapter.createElement($.HTML, NS.HTML, []);\n\n        this.treeAdapter.appendChild(this.openElements.current, element);\n        this.openElements.push(element);\n    }\n\n    _appendCommentNode(token, parent) {\n        const commentNode = this.treeAdapter.createCommentNode(token.data);\n\n        this.treeAdapter.appendChild(parent, commentNode);\n    }\n\n    _insertCharacters(token) {\n        if (this._shouldFosterParentOnInsertion()) {\n            this._fosterParentText(token.chars);\n        } else {\n            const parent = this.openElements.currentTmplContent || this.openElements.current;\n\n            this.treeAdapter.insertText(parent, token.chars);\n        }\n    }\n\n    _adoptNodes(donor, recipient) {\n        for (let child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n            this.treeAdapter.detachNode(child);\n            this.treeAdapter.appendChild(recipient, child);\n        }\n    }\n\n    //Token processing\n    _shouldProcessTokenInForeignContent(token) {\n        const current = this._getAdjustedCurrentElement();\n\n        if (!current || current === this.document) {\n            return false;\n        }\n\n        const ns = this.treeAdapter.getNamespaceURI(current);\n\n        if (ns === NS.HTML) {\n            return false;\n        }\n\n        if (\n            this.treeAdapter.getTagName(current) === $.ANNOTATION_XML &&\n            ns === NS.MATHML &&\n            token.type === Tokenizer.START_TAG_TOKEN &&\n            token.tagName === $.SVG\n        ) {\n            return false;\n        }\n\n        const isCharacterToken =\n            token.type === Tokenizer.CHARACTER_TOKEN ||\n            token.type === Tokenizer.NULL_CHARACTER_TOKEN ||\n            token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN;\n\n        const isMathMLTextStartTag =\n            token.type === Tokenizer.START_TAG_TOKEN && token.tagName !== $.MGLYPH && token.tagName !== $.MALIGNMARK;\n\n        if ((isMathMLTextStartTag || isCharacterToken) && this._isIntegrationPoint(current, NS.MATHML)) {\n            return false;\n        }\n\n        if (\n            (token.type === Tokenizer.START_TAG_TOKEN || isCharacterToken) &&\n            this._isIntegrationPoint(current, NS.HTML)\n        ) {\n            return false;\n        }\n\n        return token.type !== Tokenizer.EOF_TOKEN;\n    }\n\n    _processToken(token) {\n        TOKEN_HANDLERS[this.insertionMode][token.type](this, token);\n    }\n\n    _processTokenInBodyMode(token) {\n        TOKEN_HANDLERS[IN_BODY_MODE][token.type](this, token);\n    }\n\n    _processTokenInForeignContent(token) {\n        if (token.type === Tokenizer.CHARACTER_TOKEN) {\n            characterInForeignContent(this, token);\n        } else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\n            nullCharacterInForeignContent(this, token);\n        } else if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN) {\n            insertCharacters(this, token);\n        } else if (token.type === Tokenizer.COMMENT_TOKEN) {\n            appendComment(this, token);\n        } else if (token.type === Tokenizer.START_TAG_TOKEN) {\n            startTagInForeignContent(this, token);\n        } else if (token.type === Tokenizer.END_TAG_TOKEN) {\n            endTagInForeignContent(this, token);\n        }\n    }\n\n    _processInputToken(token) {\n        if (this._shouldProcessTokenInForeignContent(token)) {\n            this._processTokenInForeignContent(token);\n        } else {\n            this._processToken(token);\n        }\n\n        if (token.type === Tokenizer.START_TAG_TOKEN && token.selfClosing && !token.ackSelfClosing) {\n            this._err(ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n        }\n    }\n\n    //Integration points\n    _isIntegrationPoint(element, foreignNS) {\n        const tn = this.treeAdapter.getTagName(element);\n        const ns = this.treeAdapter.getNamespaceURI(element);\n        const attrs = this.treeAdapter.getAttrList(element);\n\n        return foreignContent.isIntegrationPoint(tn, ns, attrs, foreignNS);\n    }\n\n    //Active formatting elements reconstruction\n    _reconstructActiveFormattingElements() {\n        const listLength = this.activeFormattingElements.length;\n\n        if (listLength) {\n            let unopenIdx = listLength;\n            let entry = null;\n\n            do {\n                unopenIdx--;\n                entry = this.activeFormattingElements.entries[unopenIdx];\n\n                if (entry.type === FormattingElementList.MARKER_ENTRY || this.openElements.contains(entry.element)) {\n                    unopenIdx++;\n                    break;\n                }\n            } while (unopenIdx > 0);\n\n            for (let i = unopenIdx; i < listLength; i++) {\n                entry = this.activeFormattingElements.entries[i];\n                this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n                entry.element = this.openElements.current;\n            }\n        }\n    }\n\n    //Close elements\n    _closeTableCell() {\n        this.openElements.generateImpliedEndTags();\n        this.openElements.popUntilTableCellPopped();\n        this.activeFormattingElements.clearToLastMarker();\n        this.insertionMode = IN_ROW_MODE;\n    }\n\n    _closePElement() {\n        this.openElements.generateImpliedEndTagsWithExclusion($.P);\n        this.openElements.popUntilTagNamePopped($.P);\n    }\n\n    //Insertion modes\n    _resetInsertionMode() {\n        for (let i = this.openElements.stackTop, last = false; i >= 0; i--) {\n            let element = this.openElements.items[i];\n\n            if (i === 0) {\n                last = true;\n\n                if (this.fragmentContext) {\n                    element = this.fragmentContext;\n                }\n            }\n\n            const tn = this.treeAdapter.getTagName(element);\n            const newInsertionMode = INSERTION_MODE_RESET_MAP[tn];\n\n            if (newInsertionMode) {\n                this.insertionMode = newInsertionMode;\n                break;\n            } else if (!last && (tn === $.TD || tn === $.TH)) {\n                this.insertionMode = IN_CELL_MODE;\n                break;\n            } else if (!last && tn === $.HEAD) {\n                this.insertionMode = IN_HEAD_MODE;\n                break;\n            } else if (tn === $.SELECT) {\n                this._resetInsertionModeForSelect(i);\n                break;\n            } else if (tn === $.TEMPLATE) {\n                this.insertionMode = this.currentTmplInsertionMode;\n                break;\n            } else if (tn === $.HTML) {\n                this.insertionMode = this.headElement ? AFTER_HEAD_MODE : BEFORE_HEAD_MODE;\n                break;\n            } else if (last) {\n                this.insertionMode = IN_BODY_MODE;\n                break;\n            }\n        }\n    }\n\n    _resetInsertionModeForSelect(selectIdx) {\n        if (selectIdx > 0) {\n            for (let i = selectIdx - 1; i > 0; i--) {\n                const ancestor = this.openElements.items[i];\n                const tn = this.treeAdapter.getTagName(ancestor);\n\n                if (tn === $.TEMPLATE) {\n                    break;\n                } else if (tn === $.TABLE) {\n                    this.insertionMode = IN_SELECT_IN_TABLE_MODE;\n                    return;\n                }\n            }\n        }\n\n        this.insertionMode = IN_SELECT_MODE;\n    }\n\n    _pushTmplInsertionMode(mode) {\n        this.tmplInsertionModeStack.push(mode);\n        this.tmplInsertionModeStackTop++;\n        this.currentTmplInsertionMode = mode;\n    }\n\n    _popTmplInsertionMode() {\n        this.tmplInsertionModeStack.pop();\n        this.tmplInsertionModeStackTop--;\n        this.currentTmplInsertionMode = this.tmplInsertionModeStack[this.tmplInsertionModeStackTop];\n    }\n\n    //Foster parenting\n    _isElementCausesFosterParenting(element) {\n        const tn = this.treeAdapter.getTagName(element);\n\n        return tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR;\n    }\n\n    _shouldFosterParentOnInsertion() {\n        return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.current);\n    }\n\n    _findFosterParentingLocation() {\n        const location = {\n            parent: null,\n            beforeElement: null\n        };\n\n        for (let i = this.openElements.stackTop; i >= 0; i--) {\n            const openElement = this.openElements.items[i];\n            const tn = this.treeAdapter.getTagName(openElement);\n            const ns = this.treeAdapter.getNamespaceURI(openElement);\n\n            if (tn === $.TEMPLATE && ns === NS.HTML) {\n                location.parent = this.treeAdapter.getTemplateContent(openElement);\n                break;\n            } else if (tn === $.TABLE) {\n                location.parent = this.treeAdapter.getParentNode(openElement);\n\n                if (location.parent) {\n                    location.beforeElement = openElement;\n                } else {\n                    location.parent = this.openElements.items[i - 1];\n                }\n\n                break;\n            }\n        }\n\n        if (!location.parent) {\n            location.parent = this.openElements.items[0];\n        }\n\n        return location;\n    }\n\n    _fosterParentElement(element) {\n        const location = this._findFosterParentingLocation();\n\n        if (location.beforeElement) {\n            this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n        } else {\n            this.treeAdapter.appendChild(location.parent, element);\n        }\n    }\n\n    _fosterParentText(chars) {\n        const location = this._findFosterParentingLocation();\n\n        if (location.beforeElement) {\n            this.treeAdapter.insertTextBefore(location.parent, chars, location.beforeElement);\n        } else {\n            this.treeAdapter.insertText(location.parent, chars);\n        }\n    }\n\n    //Special elements\n    _isSpecialElement(element) {\n        const tn = this.treeAdapter.getTagName(element);\n        const ns = this.treeAdapter.getNamespaceURI(element);\n\n        return HTML.SPECIAL_ELEMENTS[ns][tn];\n    }\n}\n\nmodule.exports = Parser;\n\n//Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n\n//Steps 5-8 of the algorithm\nfunction aaObtainFormattingElementEntry(p, token) {\n    let formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n\n    if (formattingElementEntry) {\n        if (!p.openElements.contains(formattingElementEntry.element)) {\n            p.activeFormattingElements.removeEntry(formattingElementEntry);\n            formattingElementEntry = null;\n        } else if (!p.openElements.hasInScope(token.tagName)) {\n            formattingElementEntry = null;\n        }\n    } else {\n        genericEndTagInBody(p, token);\n    }\n\n    return formattingElementEntry;\n}\n\n//Steps 9 and 10 of the algorithm\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n    let furthestBlock = null;\n\n    for (let i = p.openElements.stackTop; i >= 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (element === formattingElementEntry.element) {\n            break;\n        }\n\n        if (p._isSpecialElement(element)) {\n            furthestBlock = element;\n        }\n    }\n\n    if (!furthestBlock) {\n        p.openElements.popUntilElementPopped(formattingElementEntry.element);\n        p.activeFormattingElements.removeEntry(formattingElementEntry);\n    }\n\n    return furthestBlock;\n}\n\n//Step 13 of the algorithm\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n    let lastElement = furthestBlock;\n    let nextElement = p.openElements.getCommonAncestor(furthestBlock);\n\n    for (let i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n        //NOTE: store next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n        nextElement = p.openElements.getCommonAncestor(element);\n\n        const elementEntry = p.activeFormattingElements.getElementEntry(element);\n        const counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n        const shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n\n        if (shouldRemoveFromOpenElements) {\n            if (counterOverflow) {\n                p.activeFormattingElements.removeEntry(elementEntry);\n            }\n\n            p.openElements.remove(element);\n        } else {\n            element = aaRecreateElementFromEntry(p, elementEntry);\n\n            if (lastElement === furthestBlock) {\n                p.activeFormattingElements.bookmark = elementEntry;\n            }\n\n            p.treeAdapter.detachNode(lastElement);\n            p.treeAdapter.appendChild(element, lastElement);\n            lastElement = element;\n        }\n    }\n\n    return lastElement;\n}\n\n//Step 13.7 of the algorithm\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n    const newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n\n    p.openElements.replace(elementEntry.element, newElement);\n    elementEntry.element = newElement;\n\n    return newElement;\n}\n\n//Step 14 of the algorithm\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n    if (p._isElementCausesFosterParenting(commonAncestor)) {\n        p._fosterParentElement(lastElement);\n    } else {\n        const tn = p.treeAdapter.getTagName(commonAncestor);\n        const ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n\n        if (tn === $.TEMPLATE && ns === NS.HTML) {\n            commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n        }\n\n        p.treeAdapter.appendChild(commonAncestor, lastElement);\n    }\n}\n\n//Steps 15-19 of the algorithm\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n    const token = formattingElementEntry.token;\n    const newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n\n    p._adoptNodes(furthestBlock, newElement);\n    p.treeAdapter.appendChild(furthestBlock, newElement);\n\n    p.activeFormattingElements.insertElementAfterBookmark(newElement, formattingElementEntry.token);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n\n    p.openElements.remove(formattingElementEntry.element);\n    p.openElements.insertAfter(furthestBlock, newElement);\n}\n\n//Algorithm entry point\nfunction callAdoptionAgency(p, token) {\n    let formattingElementEntry;\n\n    for (let i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n        formattingElementEntry = aaObtainFormattingElementEntry(p, token, formattingElementEntry);\n\n        if (!formattingElementEntry) {\n            break;\n        }\n\n        const furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n\n        if (!furthestBlock) {\n            break;\n        }\n\n        p.activeFormattingElements.bookmark = formattingElementEntry;\n\n        const lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n        const commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n\n        p.treeAdapter.detachNode(lastElement);\n        aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n        aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n    }\n}\n\n//Generic token handlers\n//------------------------------------------------------------------\nfunction ignoreToken() {\n    //NOTE: do nothing =)\n}\n\nfunction misplacedDoctype(p) {\n    p._err(ERR.misplacedDoctype);\n}\n\nfunction appendComment(p, token) {\n    p._appendCommentNode(token, p.openElements.currentTmplContent || p.openElements.current);\n}\n\nfunction appendCommentToRootHtmlElement(p, token) {\n    p._appendCommentNode(token, p.openElements.items[0]);\n}\n\nfunction appendCommentToDocument(p, token) {\n    p._appendCommentNode(token, p.document);\n}\n\nfunction insertCharacters(p, token) {\n    p._insertCharacters(token);\n}\n\nfunction stopParsing(p) {\n    p.stopped = true;\n}\n\n// The \"initial\" insertion mode\n//------------------------------------------------------------------\nfunction doctypeInInitialMode(p, token) {\n    p._setDocumentType(token);\n\n    const mode = token.forceQuirks ? HTML.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n\n    if (!doctype.isConforming(token)) {\n        p._err(ERR.nonConformingDoctype);\n    }\n\n    p.treeAdapter.setDocumentMode(p.document, mode);\n\n    p.insertionMode = BEFORE_HTML_MODE;\n}\n\nfunction tokenInInitialMode(p, token) {\n    p._err(ERR.missingDoctype, { beforeToken: true });\n    p.treeAdapter.setDocumentMode(p.document, HTML.DOCUMENT_MODE.QUIRKS);\n    p.insertionMode = BEFORE_HTML_MODE;\n    p._processToken(token);\n}\n\n// The \"before html\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHtml(p, token) {\n    if (token.tagName === $.HTML) {\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = BEFORE_HEAD_MODE;\n    } else {\n        tokenBeforeHtml(p, token);\n    }\n}\n\nfunction endTagBeforeHtml(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML || tn === $.HEAD || tn === $.BODY || tn === $.BR) {\n        tokenBeforeHtml(p, token);\n    }\n}\n\nfunction tokenBeforeHtml(p, token) {\n    p._insertFakeRootElement();\n    p.insertionMode = BEFORE_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"before head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.HEAD) {\n        p._insertElement(token, NS.HTML);\n        p.headElement = p.openElements.current;\n        p.insertionMode = IN_HEAD_MODE;\n    } else {\n        tokenBeforeHead(p, token);\n    }\n}\n\nfunction endTagBeforeHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HEAD || tn === $.BODY || tn === $.HTML || tn === $.BR) {\n        tokenBeforeHead(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenBeforeHead(p, token) {\n    p._insertFakeElement($.HEAD);\n    p.headElement = p.openElements.current;\n    p.insertionMode = IN_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"in head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.TITLE) {\n        p._switchToTextParsing(token, Tokenizer.MODE.RCDATA);\n    } else if (tn === $.NOSCRIPT) {\n        if (p.options.scriptingEnabled) {\n            p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n        } else {\n            p._insertElement(token, NS.HTML);\n            p.insertionMode = IN_HEAD_NO_SCRIPT_MODE;\n        }\n    } else if (tn === $.NOFRAMES || tn === $.STYLE) {\n        p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n    } else if (tn === $.SCRIPT) {\n        p._switchToTextParsing(token, Tokenizer.MODE.SCRIPT_DATA);\n    } else if (tn === $.TEMPLATE) {\n        p._insertTemplate(token, NS.HTML);\n        p.activeFormattingElements.insertMarker();\n        p.framesetOk = false;\n        p.insertionMode = IN_TEMPLATE_MODE;\n        p._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n    } else if (tn === $.HEAD) {\n        p._err(ERR.misplacedStartTagForHeadElement);\n    } else {\n        tokenInHead(p, token);\n    }\n}\n\nfunction endTagInHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HEAD) {\n        p.openElements.pop();\n        p.insertionMode = AFTER_HEAD_MODE;\n    } else if (tn === $.BODY || tn === $.BR || tn === $.HTML) {\n        tokenInHead(p, token);\n    } else if (tn === $.TEMPLATE) {\n        if (p.openElements.tmplCount > 0) {\n            p.openElements.generateImpliedEndTagsThoroughly();\n\n            if (p.openElements.currentTagName !== $.TEMPLATE) {\n                p._err(ERR.closingOfElementWithOpenChildElements);\n            }\n\n            p.openElements.popUntilTagNamePopped($.TEMPLATE);\n            p.activeFormattingElements.clearToLastMarker();\n            p._popTmplInsertionMode();\n            p._resetInsertionMode();\n        } else {\n            p._err(ERR.endTagWithoutMatchingOpenElement);\n        }\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenInHead(p, token) {\n    p.openElements.pop();\n    p.insertionMode = AFTER_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"in head no script\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHeadNoScript(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.HEAD ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.STYLE\n    ) {\n        startTagInHead(p, token);\n    } else if (tn === $.NOSCRIPT) {\n        p._err(ERR.nestedNoscriptInHead);\n    } else {\n        tokenInHeadNoScript(p, token);\n    }\n}\n\nfunction endTagInHeadNoScript(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.NOSCRIPT) {\n        p.openElements.pop();\n        p.insertionMode = IN_HEAD_MODE;\n    } else if (tn === $.BR) {\n        tokenInHeadNoScript(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenInHeadNoScript(p, token) {\n    const errCode =\n        token.type === Tokenizer.EOF_TOKEN ? ERR.openElementsLeftAfterEof : ERR.disallowedContentInNoscriptInHead;\n\n    p._err(errCode);\n    p.openElements.pop();\n    p.insertionMode = IN_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"after head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.BODY) {\n        p._insertElement(token, NS.HTML);\n        p.framesetOk = false;\n        p.insertionMode = IN_BODY_MODE;\n    } else if (tn === $.FRAMESET) {\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_FRAMESET_MODE;\n    } else if (\n        tn === $.BASE ||\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.SCRIPT ||\n        tn === $.STYLE ||\n        tn === $.TEMPLATE ||\n        tn === $.TITLE\n    ) {\n        p._err(ERR.abandonedHeadElementChild);\n        p.openElements.push(p.headElement);\n        startTagInHead(p, token);\n        p.openElements.remove(p.headElement);\n    } else if (tn === $.HEAD) {\n        p._err(ERR.misplacedStartTagForHeadElement);\n    } else {\n        tokenAfterHead(p, token);\n    }\n}\n\nfunction endTagAfterHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.BODY || tn === $.HTML || tn === $.BR) {\n        tokenAfterHead(p, token);\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenAfterHead(p, token) {\n    p._insertFakeElement($.BODY);\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"in body\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n}\n\nfunction characterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\n\nfunction htmlStartTagInBody(p, token) {\n    if (p.openElements.tmplCount === 0) {\n        p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n    }\n}\n\nfunction bodyStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n    if (bodyElement && p.openElements.tmplCount === 0) {\n        p.framesetOk = false;\n        p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n    }\n}\n\nfunction framesetStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n    if (p.framesetOk && bodyElement) {\n        p.treeAdapter.detachNode(bodyElement);\n        p.openElements.popAllUpToHtmlElement();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_FRAMESET_MODE;\n    }\n}\n\nfunction addressStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction numberedHeaderStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    const tn = p.openElements.currentTagName;\n\n    if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction preStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.framesetOk = false;\n}\n\nfunction formStartTagInBody(p, token) {\n    const inTemplate = p.openElements.tmplCount > 0;\n\n    if (!p.formElement || inTemplate) {\n        if (p.openElements.hasInButtonScope($.P)) {\n            p._closePElement();\n        }\n\n        p._insertElement(token, NS.HTML);\n\n        if (!inTemplate) {\n            p.formElement = p.openElements.current;\n        }\n    }\n}\n\nfunction listItemStartTagInBody(p, token) {\n    p.framesetOk = false;\n\n    const tn = token.tagName;\n\n    for (let i = p.openElements.stackTop; i >= 0; i--) {\n        const element = p.openElements.items[i];\n        const elementTn = p.treeAdapter.getTagName(element);\n        let closeTn = null;\n\n        if (tn === $.LI && elementTn === $.LI) {\n            closeTn = $.LI;\n        } else if ((tn === $.DD || tn === $.DT) && (elementTn === $.DD || elementTn === $.DT)) {\n            closeTn = elementTn;\n        }\n\n        if (closeTn) {\n            p.openElements.generateImpliedEndTagsWithExclusion(closeTn);\n            p.openElements.popUntilTagNamePopped(closeTn);\n            break;\n        }\n\n        if (elementTn !== $.ADDRESS && elementTn !== $.DIV && elementTn !== $.P && p._isSpecialElement(element)) {\n            break;\n        }\n    }\n\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction plaintextStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n}\n\nfunction buttonStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.BUTTON)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped($.BUTTON);\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n}\n\nfunction aStartTagInBody(p, token) {\n    const activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName($.A);\n\n    if (activeElementEntry) {\n        callAdoptionAgency(p, token);\n        p.openElements.remove(activeElementEntry.element);\n        p.activeFormattingElements.removeEntry(activeElementEntry);\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction bStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction nobrStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    if (p.openElements.hasInScope($.NOBR)) {\n        callAdoptionAgency(p, token);\n        p._reconstructActiveFormattingElements();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction appletStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.insertMarker();\n    p.framesetOk = false;\n}\n\nfunction tableStartTagInBody(p, token) {\n    if (\n        p.treeAdapter.getDocumentMode(p.document) !== HTML.DOCUMENT_MODE.QUIRKS &&\n        p.openElements.hasInButtonScope($.P)\n    ) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n    p.insertionMode = IN_TABLE_MODE;\n}\n\nfunction areaStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\n\nfunction inputStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, NS.HTML);\n\n    const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n    if (!inputType || inputType.toLowerCase() !== HIDDEN_INPUT_TYPE) {\n        p.framesetOk = false;\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction paramStartTagInBody(p, token) {\n    p._appendElement(token, NS.HTML);\n    token.ackSelfClosing = true;\n}\n\nfunction hrStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._appendElement(token, NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\n\nfunction imageStartTagInBody(p, token) {\n    token.tagName = $.IMG;\n    areaStartTagInBody(p, token);\n}\n\nfunction textareaStartTagInBody(p, token) {\n    p._insertElement(token, NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.tokenizer.state = Tokenizer.MODE.RCDATA;\n    p.originalInsertionMode = p.insertionMode;\n    p.framesetOk = false;\n    p.insertionMode = TEXT_MODE;\n}\n\nfunction xmpStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._reconstructActiveFormattingElements();\n    p.framesetOk = false;\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction iframeStartTagInBody(p, token) {\n    p.framesetOk = false;\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\n//NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as a rawtext.\nfunction noembedStartTagInBody(p, token) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction selectStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n\n    if (\n        p.insertionMode === IN_TABLE_MODE ||\n        p.insertionMode === IN_CAPTION_MODE ||\n        p.insertionMode === IN_TABLE_BODY_MODE ||\n        p.insertionMode === IN_ROW_MODE ||\n        p.insertionMode === IN_CELL_MODE\n    ) {\n        p.insertionMode = IN_SELECT_IN_TABLE_MODE;\n    } else {\n        p.insertionMode = IN_SELECT_MODE;\n    }\n}\n\nfunction optgroupStartTagInBody(p, token) {\n    if (p.openElements.currentTagName === $.OPTION) {\n        p.openElements.pop();\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n}\n\nfunction rbStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.RUBY)) {\n        p.openElements.generateImpliedEndTags();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction rtStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.RUBY)) {\n        p.openElements.generateImpliedEndTagsWithExclusion($.RTC);\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction menuStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction mathStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    foreignContent.adjustTokenMathMLAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n        p._appendElement(token, NS.MATHML);\n    } else {\n        p._insertElement(token, NS.MATHML);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction svgStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    foreignContent.adjustTokenSVGAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n        p._appendElement(token, NS.SVG);\n    } else {\n        p._insertElement(token, NS.SVG);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction genericStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n}\n\n//OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\nfunction startTagInBody(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 1:\n            if (tn === $.I || tn === $.S || tn === $.B || tn === $.U) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.P) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.A) {\n                aStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 2:\n            if (tn === $.DL || tn === $.OL || tn === $.UL) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n                numberedHeaderStartTagInBody(p, token);\n            } else if (tn === $.LI || tn === $.DD || tn === $.DT) {\n                listItemStartTagInBody(p, token);\n            } else if (tn === $.EM || tn === $.TT) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.BR) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.HR) {\n                hrStartTagInBody(p, token);\n            } else if (tn === $.RB) {\n                rbStartTagInBody(p, token);\n            } else if (tn === $.RT || tn === $.RP) {\n                rtStartTagInBody(p, token);\n            } else if (tn !== $.TH && tn !== $.TD && tn !== $.TR) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.DIV || tn === $.DIR || tn === $.NAV) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.PRE) {\n                preStartTagInBody(p, token);\n            } else if (tn === $.BIG) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.IMG || tn === $.WBR) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.XMP) {\n                xmpStartTagInBody(p, token);\n            } else if (tn === $.SVG) {\n                svgStartTagInBody(p, token);\n            } else if (tn === $.RTC) {\n                rbStartTagInBody(p, token);\n            } else if (tn !== $.COL) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.HTML) {\n                htmlStartTagInBody(p, token);\n            } else if (tn === $.BASE || tn === $.LINK || tn === $.META) {\n                startTagInHead(p, token);\n            } else if (tn === $.BODY) {\n                bodyStartTagInBody(p, token);\n            } else if (tn === $.MAIN || tn === $.MENU) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.FORM) {\n                formStartTagInBody(p, token);\n            } else if (tn === $.CODE || tn === $.FONT) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.NOBR) {\n                nobrStartTagInBody(p, token);\n            } else if (tn === $.AREA) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.MATH) {\n                mathStartTagInBody(p, token);\n            } else if (tn === $.MENU) {\n                menuStartTagInBody(p, token);\n            } else if (tn !== $.HEAD) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.STYLE || tn === $.TITLE) {\n                startTagInHead(p, token);\n            } else if (tn === $.ASIDE) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.SMALL) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.TABLE) {\n                tableStartTagInBody(p, token);\n            } else if (tn === $.EMBED) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.INPUT) {\n                inputStartTagInBody(p, token);\n            } else if (tn === $.PARAM || tn === $.TRACK) {\n                paramStartTagInBody(p, token);\n            } else if (tn === $.IMAGE) {\n                imageStartTagInBody(p, token);\n            } else if (tn !== $.FRAME && tn !== $.TBODY && tn !== $.TFOOT && tn !== $.THEAD) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (tn === $.SCRIPT) {\n                startTagInHead(p, token);\n            } else if (\n                tn === $.CENTER ||\n                tn === $.FIGURE ||\n                tn === $.FOOTER ||\n                tn === $.HEADER ||\n                tn === $.HGROUP ||\n                tn === $.DIALOG\n            ) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.BUTTON) {\n                buttonStartTagInBody(p, token);\n            } else if (tn === $.STRIKE || tn === $.STRONG) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.APPLET || tn === $.OBJECT) {\n                appletStartTagInBody(p, token);\n            } else if (tn === $.KEYGEN) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.SOURCE) {\n                paramStartTagInBody(p, token);\n            } else if (tn === $.IFRAME) {\n                iframeStartTagInBody(p, token);\n            } else if (tn === $.SELECT) {\n                selectStartTagInBody(p, token);\n            } else if (tn === $.OPTION) {\n                optgroupStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (tn === $.BGSOUND) {\n                startTagInHead(p, token);\n            } else if (\n                tn === $.DETAILS ||\n                tn === $.ADDRESS ||\n                tn === $.ARTICLE ||\n                tn === $.SECTION ||\n                tn === $.SUMMARY\n            ) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.LISTING) {\n                preStartTagInBody(p, token);\n            } else if (tn === $.MARQUEE) {\n                appletStartTagInBody(p, token);\n            } else if (tn === $.NOEMBED) {\n                noembedStartTagInBody(p, token);\n            } else if (tn !== $.CAPTION) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.BASEFONT) {\n                startTagInHead(p, token);\n            } else if (tn === $.FRAMESET) {\n                framesetStartTagInBody(p, token);\n            } else if (tn === $.FIELDSET) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.TEXTAREA) {\n                textareaStartTagInBody(p, token);\n            } else if (tn === $.TEMPLATE) {\n                startTagInHead(p, token);\n            } else if (tn === $.NOSCRIPT) {\n                if (p.options.scriptingEnabled) {\n                    noembedStartTagInBody(p, token);\n                } else {\n                    genericStartTagInBody(p, token);\n                }\n            } else if (tn === $.OPTGROUP) {\n                optgroupStartTagInBody(p, token);\n            } else if (tn !== $.COLGROUP) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 9:\n            if (tn === $.PLAINTEXT) {\n                plaintextStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 10:\n            if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n                addressStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        default:\n            genericStartTagInBody(p, token);\n    }\n}\n\nfunction bodyEndTagInBody(p) {\n    if (p.openElements.hasInScope($.BODY)) {\n        p.insertionMode = AFTER_BODY_MODE;\n    }\n}\n\nfunction htmlEndTagInBody(p, token) {\n    if (p.openElements.hasInScope($.BODY)) {\n        p.insertionMode = AFTER_BODY_MODE;\n        p._processToken(token);\n    }\n}\n\nfunction addressEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\n\nfunction formEndTagInBody(p) {\n    const inTemplate = p.openElements.tmplCount > 0;\n    const formElement = p.formElement;\n\n    if (!inTemplate) {\n        p.formElement = null;\n    }\n\n    if ((formElement || inTemplate) && p.openElements.hasInScope($.FORM)) {\n        p.openElements.generateImpliedEndTags();\n\n        if (inTemplate) {\n            p.openElements.popUntilTagNamePopped($.FORM);\n        } else {\n            p.openElements.remove(formElement);\n        }\n    }\n}\n\nfunction pEndTagInBody(p) {\n    if (!p.openElements.hasInButtonScope($.P)) {\n        p._insertFakeElement($.P);\n    }\n\n    p._closePElement();\n}\n\nfunction liEndTagInBody(p) {\n    if (p.openElements.hasInListItemScope($.LI)) {\n        p.openElements.generateImpliedEndTagsWithExclusion($.LI);\n        p.openElements.popUntilTagNamePopped($.LI);\n    }\n}\n\nfunction ddEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTagsWithExclusion(tn);\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\n\nfunction numberedHeaderEndTagInBody(p) {\n    if (p.openElements.hasNumberedHeaderInScope()) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilNumberedHeaderPopped();\n    }\n}\n\nfunction appletEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n        p.activeFormattingElements.clearToLastMarker();\n    }\n}\n\nfunction brEndTagInBody(p) {\n    p._reconstructActiveFormattingElements();\n    p._insertFakeElement($.BR);\n    p.openElements.pop();\n    p.framesetOk = false;\n}\n\nfunction genericEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (p.treeAdapter.getTagName(element) === tn) {\n            p.openElements.generateImpliedEndTagsWithExclusion(tn);\n            p.openElements.popUntilElementPopped(element);\n            break;\n        }\n\n        if (p._isSpecialElement(element)) {\n            break;\n        }\n    }\n}\n\n//OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\nfunction endTagInBody(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 1:\n            if (tn === $.A || tn === $.B || tn === $.I || tn === $.S || tn === $.U) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.P) {\n                pEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 2:\n            if (tn === $.DL || tn === $.UL || tn === $.OL) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.LI) {\n                liEndTagInBody(p, token);\n            } else if (tn === $.DD || tn === $.DT) {\n                ddEndTagInBody(p, token);\n            } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n                numberedHeaderEndTagInBody(p, token);\n            } else if (tn === $.BR) {\n                brEndTagInBody(p, token);\n            } else if (tn === $.EM || tn === $.TT) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.BIG) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.DIR || tn === $.DIV || tn === $.NAV || tn === $.PRE) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.BODY) {\n                bodyEndTagInBody(p, token);\n            } else if (tn === $.HTML) {\n                htmlEndTagInBody(p, token);\n            } else if (tn === $.FORM) {\n                formEndTagInBody(p, token);\n            } else if (tn === $.CODE || tn === $.FONT || tn === $.NOBR) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.MAIN || tn === $.MENU) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.ASIDE) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.SMALL) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (\n                tn === $.CENTER ||\n                tn === $.FIGURE ||\n                tn === $.FOOTER ||\n                tn === $.HEADER ||\n                tn === $.HGROUP ||\n                tn === $.DIALOG\n            ) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.APPLET || tn === $.OBJECT) {\n                appletEndTagInBody(p, token);\n            } else if (tn === $.STRIKE || tn === $.STRONG) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (\n                tn === $.ADDRESS ||\n                tn === $.ARTICLE ||\n                tn === $.DETAILS ||\n                tn === $.SECTION ||\n                tn === $.SUMMARY ||\n                tn === $.LISTING\n            ) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.MARQUEE) {\n                appletEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.FIELDSET) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.TEMPLATE) {\n                endTagInHead(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 10:\n            if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        default:\n            genericEndTagInBody(p, token);\n    }\n}\n\nfunction eofInBody(p, token) {\n    if (p.tmplInsertionModeStackTop > -1) {\n        eofInTemplate(p, token);\n    } else {\n        p.stopped = true;\n    }\n}\n\n// The \"text\" insertion mode\n//------------------------------------------------------------------\nfunction endTagInText(p, token) {\n    if (token.tagName === $.SCRIPT) {\n        p.pendingScript = p.openElements.current;\n    }\n\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n}\n\nfunction eofInText(p, token) {\n    p._err(ERR.eofInElementThatCanContainOnlyText);\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n    p._processToken(token);\n}\n\n// The \"in table\" insertion mode\n//------------------------------------------------------------------\nfunction characterInTable(p, token) {\n    const curTn = p.openElements.currentTagName;\n\n    if (curTn === $.TABLE || curTn === $.TBODY || curTn === $.TFOOT || curTn === $.THEAD || curTn === $.TR) {\n        p.pendingCharacterTokens = [];\n        p.hasNonWhitespacePendingCharacterToken = false;\n        p.originalInsertionMode = p.insertionMode;\n        p.insertionMode = IN_TABLE_TEXT_MODE;\n        p._processToken(token);\n    } else {\n        tokenInTable(p, token);\n    }\n}\n\nfunction captionStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p.activeFormattingElements.insertMarker();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_CAPTION_MODE;\n}\n\nfunction colgroupStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_COLUMN_GROUP_MODE;\n}\n\nfunction colStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement($.COLGROUP);\n    p.insertionMode = IN_COLUMN_GROUP_MODE;\n    p._processToken(token);\n}\n\nfunction tbodyStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_TABLE_BODY_MODE;\n}\n\nfunction tdStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement($.TBODY);\n    p.insertionMode = IN_TABLE_BODY_MODE;\n    p._processToken(token);\n}\n\nfunction tableStartTagInTable(p, token) {\n    if (p.openElements.hasInTableScope($.TABLE)) {\n        p.openElements.popUntilTagNamePopped($.TABLE);\n        p._resetInsertionMode();\n        p._processToken(token);\n    }\n}\n\nfunction inputStartTagInTable(p, token) {\n    const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n    if (inputType && inputType.toLowerCase() === HIDDEN_INPUT_TYPE) {\n        p._appendElement(token, NS.HTML);\n    } else {\n        tokenInTable(p, token);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction formStartTagInTable(p, token) {\n    if (!p.formElement && p.openElements.tmplCount === 0) {\n        p._insertElement(token, NS.HTML);\n        p.formElement = p.openElements.current;\n        p.openElements.pop();\n    }\n}\n\nfunction startTagInTable(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 2:\n            if (tn === $.TD || tn === $.TH || tn === $.TR) {\n                tdStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.COL) {\n                colStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.FORM) {\n                formStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.TABLE) {\n                tableStartTagInTable(p, token);\n            } else if (tn === $.STYLE) {\n                startTagInHead(p, token);\n            } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n                tbodyStartTagInTable(p, token);\n            } else if (tn === $.INPUT) {\n                inputStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (tn === $.SCRIPT) {\n                startTagInHead(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (tn === $.CAPTION) {\n                captionStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.COLGROUP) {\n                colgroupStartTagInTable(p, token);\n            } else if (tn === $.TEMPLATE) {\n                startTagInHead(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        default:\n            tokenInTable(p, token);\n    }\n}\n\nfunction endTagInTable(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.TABLE)) {\n            p.openElements.popUntilTagNamePopped($.TABLE);\n            p._resetInsertionMode();\n        }\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else if (\n        tn !== $.BODY &&\n        tn !== $.CAPTION &&\n        tn !== $.COL &&\n        tn !== $.COLGROUP &&\n        tn !== $.HTML &&\n        tn !== $.TBODY &&\n        tn !== $.TD &&\n        tn !== $.TFOOT &&\n        tn !== $.TH &&\n        tn !== $.THEAD &&\n        tn !== $.TR\n    ) {\n        tokenInTable(p, token);\n    }\n}\n\nfunction tokenInTable(p, token) {\n    const savedFosterParentingState = p.fosterParentingEnabled;\n\n    p.fosterParentingEnabled = true;\n    p._processTokenInBodyMode(token);\n    p.fosterParentingEnabled = savedFosterParentingState;\n}\n\n// The \"in table text\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n}\n\nfunction characterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n    p.hasNonWhitespacePendingCharacterToken = true;\n}\n\nfunction tokenInTableText(p, token) {\n    let i = 0;\n\n    if (p.hasNonWhitespacePendingCharacterToken) {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            tokenInTable(p, p.pendingCharacterTokens[i]);\n        }\n    } else {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            p._insertCharacters(p.pendingCharacterTokens[i]);\n        }\n    }\n\n    p.insertionMode = p.originalInsertionMode;\n    p._processToken(token);\n}\n\n// The \"in caption\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCaption(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TD ||\n        tn === $.TFOOT ||\n        tn === $.TH ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.CAPTION)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped($.CAPTION);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInBody(p, token);\n    }\n}\n\nfunction endTagInCaption(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.CAPTION || tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.CAPTION)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped($.CAPTION);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_TABLE_MODE;\n\n            if (tn === $.TABLE) {\n                p._processToken(token);\n            }\n        }\n    } else if (\n        tn !== $.BODY &&\n        tn !== $.COL &&\n        tn !== $.COLGROUP &&\n        tn !== $.HTML &&\n        tn !== $.TBODY &&\n        tn !== $.TD &&\n        tn !== $.TFOOT &&\n        tn !== $.TH &&\n        tn !== $.THEAD &&\n        tn !== $.TR\n    ) {\n        endTagInBody(p, token);\n    }\n}\n\n// The \"in column group\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInColumnGroup(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.COL) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n    } else {\n        tokenInColumnGroup(p, token);\n    }\n}\n\nfunction endTagInColumnGroup(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.COLGROUP) {\n        if (p.openElements.currentTagName === $.COLGROUP) {\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n        }\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else if (tn !== $.COL) {\n        tokenInColumnGroup(p, token);\n    }\n}\n\nfunction tokenInColumnGroup(p, token) {\n    if (p.openElements.currentTagName === $.COLGROUP) {\n        p.openElements.pop();\n        p.insertionMode = IN_TABLE_MODE;\n        p._processToken(token);\n    }\n}\n\n// The \"in table body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTableBody(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TR) {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_ROW_MODE;\n    } else if (tn === $.TH || tn === $.TD) {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertFakeElement($.TR);\n        p.insertionMode = IN_ROW_MODE;\n        p._processToken(token);\n    } else if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD\n    ) {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInTable(p, token);\n    }\n}\n\nfunction endTagInTableBody(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n        }\n    } else if (tn === $.TABLE) {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else if (\n        (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP) ||\n        (tn !== $.HTML && tn !== $.TD && tn !== $.TH && tn !== $.TR)\n    ) {\n        endTagInTable(p, token);\n    }\n}\n\n// The \"in row\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInRow(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TH || tn === $.TD) {\n        p.openElements.clearBackToTableRowContext();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_CELL_MODE;\n        p.activeFormattingElements.insertMarker();\n    } else if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInTable(p, token);\n    }\n}\n\nfunction endTagInRow(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TR) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n        }\n    } else if (tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        if (p.openElements.hasInTableScope(tn) || p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else if (\n        (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP) ||\n        (tn !== $.HTML && tn !== $.TD && tn !== $.TH)\n    ) {\n        endTagInTable(p, token);\n    }\n}\n\n// The \"in cell\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCell(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TD ||\n        tn === $.TFOOT ||\n        tn === $.TH ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.TD) || p.openElements.hasInTableScope($.TH)) {\n            p._closeTableCell();\n            p._processToken(token);\n        }\n    } else {\n        startTagInBody(p, token);\n    }\n}\n\nfunction endTagInCell(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TD || tn === $.TH) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped(tn);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_ROW_MODE;\n        }\n    } else if (tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p._closeTableCell();\n            p._processToken(token);\n        }\n    } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML) {\n        endTagInBody(p, token);\n    }\n}\n\n// The \"in select\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelect(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.OPTION) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.OPTGROUP) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n\n        if (p.openElements.currentTagName === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.INPUT || tn === $.KEYGEN || tn === $.TEXTAREA || tn === $.SELECT) {\n        if (p.openElements.hasInSelectScope($.SELECT)) {\n            p.openElements.popUntilTagNamePopped($.SELECT);\n            p._resetInsertionMode();\n\n            if (tn !== $.SELECT) {\n                p._processToken(token);\n            }\n        }\n    } else if (tn === $.SCRIPT || tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagInSelect(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.OPTGROUP) {\n        const prevOpenElement = p.openElements.items[p.openElements.stackTop - 1];\n        const prevOpenElementTn = prevOpenElement && p.treeAdapter.getTagName(prevOpenElement);\n\n        if (p.openElements.currentTagName === $.OPTION && prevOpenElementTn === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n\n        if (p.openElements.currentTagName === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n    } else if (tn === $.OPTION) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n    } else if (tn === $.SELECT && p.openElements.hasInSelectScope($.SELECT)) {\n        p.openElements.popUntilTagNamePopped($.SELECT);\n        p._resetInsertionMode();\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    }\n}\n\n//12.2.5.4.17 The \"in select in table\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelectInTable(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.TABLE ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR ||\n        tn === $.TD ||\n        tn === $.TH\n    ) {\n        p.openElements.popUntilTagNamePopped($.SELECT);\n        p._resetInsertionMode();\n        p._processToken(token);\n    } else {\n        startTagInSelect(p, token);\n    }\n}\n\nfunction endTagInSelectInTable(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.TABLE ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR ||\n        tn === $.TD ||\n        tn === $.TH\n    ) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.popUntilTagNamePopped($.SELECT);\n            p._resetInsertionMode();\n            p._processToken(token);\n        }\n    } else {\n        endTagInSelect(p, token);\n    }\n}\n\n// The \"in template\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTemplate(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.BASE ||\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.SCRIPT ||\n        tn === $.STYLE ||\n        tn === $.TEMPLATE ||\n        tn === $.TITLE\n    ) {\n        startTagInHead(p, token);\n    } else {\n        const newInsertionMode = TEMPLATE_INSERTION_MODE_SWITCH_MAP[tn] || IN_BODY_MODE;\n\n        p._popTmplInsertionMode();\n        p._pushTmplInsertionMode(newInsertionMode);\n        p.insertionMode = newInsertionMode;\n        p._processToken(token);\n    }\n}\n\nfunction endTagInTemplate(p, token) {\n    if (token.tagName === $.TEMPLATE) {\n        endTagInHead(p, token);\n    }\n}\n\nfunction eofInTemplate(p, token) {\n    if (p.openElements.tmplCount > 0) {\n        p.openElements.popUntilTagNamePopped($.TEMPLATE);\n        p.activeFormattingElements.clearToLastMarker();\n        p._popTmplInsertionMode();\n        p._resetInsertionMode();\n        p._processToken(token);\n    } else {\n        p.stopped = true;\n    }\n}\n\n// The \"after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        startTagInBody(p, token);\n    } else {\n        tokenAfterBody(p, token);\n    }\n}\n\nfunction endTagAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        if (!p.fragmentContext) {\n            p.insertionMode = AFTER_AFTER_BODY_MODE;\n        }\n    } else {\n        tokenAfterBody(p, token);\n    }\n}\n\nfunction tokenAfterBody(p, token) {\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"in frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.FRAMESET) {\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.FRAME) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagInFrameset(p, token) {\n    if (token.tagName === $.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n        p.openElements.pop();\n\n        if (!p.fragmentContext && p.openElements.currentTagName !== $.FRAMESET) {\n            p.insertionMode = AFTER_FRAMESET_MODE;\n        }\n    }\n}\n\n// The \"after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagAfterFrameset(p, token) {\n    if (token.tagName === $.HTML) {\n        p.insertionMode = AFTER_AFTER_FRAMESET_MODE;\n    }\n}\n\n// The \"after after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        startTagInBody(p, token);\n    } else {\n        tokenAfterAfterBody(p, token);\n    }\n}\n\nfunction tokenAfterAfterBody(p, token) {\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\n// The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\nfunction nullCharacterInForeignContent(p, token) {\n    token.chars = unicode.REPLACEMENT_CHARACTER;\n    p._insertCharacters(token);\n}\n\nfunction characterInForeignContent(p, token) {\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\n\nfunction startTagInForeignContent(p, token) {\n    if (foreignContent.causesExit(token) && !p.fragmentContext) {\n        while (\n            p.treeAdapter.getNamespaceURI(p.openElements.current) !== NS.HTML &&\n            !p._isIntegrationPoint(p.openElements.current)\n        ) {\n            p.openElements.pop();\n        }\n\n        p._processToken(token);\n    } else {\n        const current = p._getAdjustedCurrentElement();\n        const currentNs = p.treeAdapter.getNamespaceURI(current);\n\n        if (currentNs === NS.MATHML) {\n            foreignContent.adjustTokenMathMLAttrs(token);\n        } else if (currentNs === NS.SVG) {\n            foreignContent.adjustTokenSVGTagName(token);\n            foreignContent.adjustTokenSVGAttrs(token);\n        }\n\n        foreignContent.adjustTokenXMLAttrs(token);\n\n        if (token.selfClosing) {\n            p._appendElement(token, currentNs);\n        } else {\n            p._insertElement(token, currentNs);\n        }\n\n        token.ackSelfClosing = true;\n    }\n}\n\nfunction endTagInForeignContent(p, token) {\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (p.treeAdapter.getNamespaceURI(element) === NS.HTML) {\n            p._processToken(token);\n            break;\n        }\n\n        if (p.treeAdapter.getTagName(element).toLowerCase() === token.tagName) {\n            p.openElements.popUntilElementPopped(element);\n            break;\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"script"}